
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Ranking data &#8212; OpenGHG 0+untagged.1.gb635624 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/local/Managing_object_store/Data_ranking';</script>
    <script src="../../../_static/custom.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../../index.html">

  
  
  
  
  
  
  

  
    <img src="../../../_static/./images/OpenGHG_Logo_NoText.png" class="logo__image only-light" alt="Logo image">
    <img src="../../../_static/./images/OpenGHG_Logo_NoText.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index.html">
                        User API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../development/index_devel.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index_devapi.html">
                        Developer API
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../whatsnew/index.html">
                        What’s new
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index.html">
                        User API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../development/index_devel.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index_devapi.html">
                        Developer API
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../whatsnew/index.html">
                        What’s new
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="ranking-data">
<h1>Ranking data<a class="headerlink" href="#ranking-data" title="Permalink to this heading">#</a></h1>
<p>Sometimes within the object store there will be multiple pieces of data which fulfill a similiar criteria but where one is preferred over the other in certain situations. The most common example of this is with measurements taken at sites where there multiple inlets at different heights. Having all data available is useful but it is often the case that the user will want to use the most representative data for a time period. Ranking is a way for users to rank data sets within a time period to apply that expert preference within an object store and to simplify the workflow for users of the data.</p>
<dl class="simple">
<dt>To set the ranking for complementary datasets a few pieces of information will need to be provided:</dt><dd><ol class="arabic simple">
<li><p>The associated keys and values for the data sources you want to add the rule for e.g. site, inlet, species values</p></li>
<li><p>The associated key for the data sources which will be <em>different</em> between the datasets e.g. the keyword “inlet” (the value of this must be included in 1.)</p></li>
<li><p>The date range this is relevant to</p></li>
</ol>
</dd>
</dl>
<p>For more than 1 ranking input, the order that these pieces of information are stored will determine what is returned when the ranking is applied. This will initially be determined by the order the ranks are added, with the most recent being the most important, <strong>but this can be modified as needed</strong> (REQUIREMENT - CHECK WE CAN DO THIS).</p>
<p>E.g. for data from Tacolneston which spans, in this example, from 2009-2012, and all inlets were available for the whole time period:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">add_data_rank</span><span class="p">(</span><span class="n">match</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;site&quot;</span><span class="p">:</span> <span class="s2">&quot;tac&quot;</span><span class="p">,</span> <span class="s2">&quot;inlet&quot;</span><span class="p">:</span> <span class="s2">&quot;100m&quot;</span><span class="p">},</span> <span class="n">different</span><span class="o">=</span><span class="s2">&quot;inlet&quot;</span><span class="p">)</span>  <span class="c1"># OMITTING start and end dates - should cover whole range</span>
<span class="n">add_data_rank</span><span class="p">(</span><span class="n">match</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;site&quot;</span><span class="p">:</span> <span class="s2">&quot;tac&quot;</span><span class="p">,</span> <span class="s2">&quot;species&quot;</span><span class="p">:</span> <span class="s2">&quot;co2&quot;</span><span class="p">,</span> <span class="s2">&quot;inlet&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">},</span> <span class="n">different</span><span class="o">=</span><span class="s2">&quot;inlet&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2013-01-01&quot;</span><span class="p">)</span>  <span class="c1"># Or could omit end_date here..?</span>
</pre></div>
</div>
<p>For two datasets, for co2 this should be interpreted as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dataset</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">100</span><span class="n">m</span><span class="p">;</span> <span class="n">Dataset</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="n">m</span>

<span class="n">ALL</span> <span class="n">DATA</span>          <span class="o">|--------------------------------------------|</span>
<span class="n">Rule</span> <span class="n">A</span> <span class="o">-</span> <span class="mi">100</span><span class="n">m</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><span class="o">|</span>
<span class="n">Rule</span> <span class="n">B</span> <span class="o">-</span> <span class="mi">10</span><span class="n">m</span>  <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span>                               <span class="n">xxxxxxxxxxxxx</span><span class="o">|</span>
<span class="n">Resolved</span>          <span class="o">|</span><span class="mi">11111111111111111111111111111112222222222222</span><span class="o">|</span>
</pre></div>
</div>
<p>For other gases this should be interpreted as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALL</span> <span class="n">DATA</span>          <span class="o">|--------------------------------------------|</span>
<span class="n">Rule</span> <span class="n">A</span> <span class="o">-</span> <span class="mi">100</span><span class="n">m</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><span class="o">|</span>
<span class="n">Resolved</span>          <span class="o">|</span><span class="mi">11111111111111111111111111111111111111111111</span><span class="o">|</span>
</pre></div>
</div>
<section id="viewing-current-ranks">
<h2>Viewing current ranks<a class="headerlink" href="#viewing-current-ranks" title="Permalink to this heading">#</a></h2>
<p>To see all the current rank rules you can use the function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">view_data_ranks</span><span class="p">()</span>  <span class="c1"># This will show all rank information</span>
</pre></div>
</div>
<p>This will return a pandas DataFrame with the rank details as stored.</p>
<p>You can also refine your view by passing keywords:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">view_data_ranks</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="s2">&quot;tac&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To view associated rules / ranks for a set of datasets as a plot the <em class="xref py py-obj">plot_rank_stack</em> plotting function can be used. For example to see the rules associated with Tacolneston co2 data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_rank_stack</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="s2">&quot;tac&quot;</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s2">&quot;co2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If an unambiguous stack which cannot be determined you will be asked to provide more details e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_rank_stack</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="s2">&quot;tac&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>is not refined enough as there are different rules for different gases meaning this can’t be visualised simply as a stack.</p>
<p>&gt; <strong>QUESTION:</strong></p>
<p><strong>HOW WOULD WE DETERMINE AN UNAMBIGUOUS STACK VERSUS AMBIGUOS - WHAT DOES THAT MEAN?</strong> - Could include “different” column in database which includes the key for the value which is different e.g. just the keyword “inlet”. Maybe ambiguous could be “can’t have anything else different than the ‘different’ column”?</p>
<p>&gt; <strong>QUESTION:</strong> Would something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_rank_stack</span><span class="p">(</span><span class="n">keywords</span><span class="o">=</span><span class="p">{</span><span class="n">site</span><span class="p">:</span><span class="s2">&quot;tac&quot;</span><span class="p">,</span> <span class="n">species</span><span class="p">:</span><span class="s2">&quot;co2&quot;</span><span class="p">})</span>
</pre></div>
</div>
<p>be better? For consistency with add_data_rank? Or should we update add_data_rank?</p>
</section>
<section id="updating-deleting-reordering-ranks">
<h2>Updating / deleting (/reordering) ranks<a class="headerlink" href="#updating-deleting-reordering-ranks" title="Permalink to this heading">#</a></h2>
<p>&gt; <strong>QUESTION: Should these be created to use (`match` or keywords) and `different`??</strong></p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">delete_data_rank</span><span class="p">(</span><span class="n">match</span><span class="o">=</span><span class="p">{</span><span class="n">site</span><span class="p">:</span><span class="s2">&quot;tac&quot;</span><span class="p">,</span> <span class="n">species</span><span class="p">:</span><span class="s2">&quot;co2&quot;</span><span class="p">,</span> <span class="n">inlet</span><span class="p">:</span><span class="s2">&quot;10m&quot;</span><span class="p">},</span> <span class="n">different</span><span class="o">=</span><span class="s2">&quot;inlet&quot;</span><span class="p">)</span>  <span class="c1"># ???</span>

<span class="n">update_data_rank</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># More complex - what needs updating? How does this need to be updated?</span>
</pre></div>
</div>
<p>&gt; <strong>QUESTION:Could reordered be included as part of update or it’s own thing? Or too difficult? Maybe rather than reordering suggest, deleting and readding? Would need to be easy to do…</strong></p>
<p>&gt; <strong>QUESTION: Back up and restore?</strong></p>
</section>
<section id="using-the-ranks">
<h2>Using the ranks<a class="headerlink" href="#using-the-ranks" title="Permalink to this heading">#</a></h2>
<p><em>This is the real question…</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_obs_surface</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ranking</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># By default</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">search_results</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ranking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># By default</span>
</pre></div>
</div>
<ul class="simple">
<li><p>If single source can’t be resolved from the ranking - return an error</p></li>
</ul>
<p>(Ranking could be applied in the layer between search and retrieve).</p>
</section>
<section id="code-design">
<h2>Code design<a class="headerlink" href="#code-design" title="Permalink to this heading">#</a></h2>
<dl class="simple">
<dt>Overall requirements</dt><dd><ul class="simple">
<li><p>Order of ranks determines importance</p></li>
<li><p>Ability to re-order the ranking?</p></li>
<li><p>Ability to delete ranks from the database</p></li>
</ul>
</dd>
<dt>Functions:</dt><dd><ul class="simple">
<li><p>add_data_rank - add new rank to database</p></li>
<li><p>view_data_ranks - view current ranks in database</p></li>
<li><p>plot_rank_stack - plot ranks as a stack (selected ranks need to be plottable as a stack)</p></li>
<li><p>delete_data_rank - delete rank from database</p></li>
<li><p>update_data_rank - update rank in database</p></li>
<li><p>UPDATE: retrieve method of search results?</p></li>
<li><p>UPDATE: <a href="#id1"><span class="problematic" id="id2">get_</span></a>… functions (should link to search results but need to add additional input for ranking=True)</p></li>
</ul>
</dd>
<dt>add_data_rank function (or add_data_rule, add_rank function?)</dt><dd><ul class="simple">
<li><p>Inputs:</p>
<ul>
<li><p>keys and values for data (doesn’t have to map to exactly one data source?)</p></li>
<li><p>different keys (how does that work for inlet=53m etc…)</p></li>
<li><p>start_date and end_date (i.e. date range) BUT if they’re not passed that’s fine we should be able to infer from the data?</p></li>
</ul>
</li>
<li><p>Can we use these inputs to grab all relevant data in the database?</p></li>
</ul>
</dd>
</dl>
<p>&gt; <strong>QUESTION:</strong> How do we grab the rules from the database to build up the stack? Seems like this could be a filtering and pandas question…?</p>
<dl class="simple">
<dt>plot_rank_stack function</dt><dd><ul class="simple">
<li><p>Do we want to allow largely keywords arguments here?</p>
<ul>
<li><p>And/or just the same dictionary form as used for add_data_rank?</p></li>
</ul>
</li>
<li><p>Needs to produce a sensible error message if an “unambiguous” stack cannot be determined - just needs to find a useful way to ask for more keywords?</p></li>
<li><p>Show rules in rows, alongside overall determined information to be passed back.</p></li>
</ul>
</dd>
</dl>
<p>get_obs_surface(…, ranking=True)  # By default</p>
<p>search_results.retrieve(…, ranking=False) # By default</p>
<dl>
<dt>Ranking could be applied in the layer between search and retrieve.</dt><dd><ul>
<li><p>Need to think about how this is applied…</p></li>
<li><p>What could be returned from the <em class="xref py py-obj">combine_rank</em> type function and how can this be applied?</p>
<blockquote>
<div><ul class="simple">
<li><p>Within Experiment_rank_opinions.py this was returned as a list of dictionaries containing continuous sets of dates - would this be better as an object…? Or does not everything need to be an object…?</p></li>
<li><p>List of <em class="xref py py-obj">Rank</em> type objects? DataClass with start, end, keys (and different?) for example</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expected_output</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2011-01-01&quot;</span><span class="p">),</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">),</span> <span class="s2">&quot;keys&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">},</span>
                   <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">),</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2012-06-01&quot;</span><span class="p">),</span> <span class="s2">&quot;keys&quot;</span><span class="p">:{</span><span class="s2">&quot;inlet&quot;</span><span class="p">:</span><span class="s2">&quot;10m&quot;</span><span class="p">}},</span>
                   <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2012-06-01&quot;</span><span class="p">),</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2012-09-01&quot;</span><span class="p">),</span> <span class="s2">&quot;keys&quot;</span><span class="p">:{</span><span class="s2">&quot;inlet&quot;</span><span class="p">:</span><span class="s2">&quot;50m&quot;</span><span class="p">}},</span>
                   <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2012-09-01&quot;</span><span class="p">),</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2012-12-01&quot;</span><span class="p">),</span> <span class="s2">&quot;keys&quot;</span><span class="p">:{</span><span class="s2">&quot;inlet&quot;</span><span class="p">:</span><span class="s2">&quot;100m&quot;</span><span class="p">}},</span>
                   <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2012-12-01&quot;</span><span class="p">),</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2013-01-01&quot;</span><span class="p">),</span> <span class="s2">&quot;keys&quot;</span><span class="p">:{</span><span class="s2">&quot;inlet&quot;</span><span class="p">:</span><span class="s2">&quot;50m&quot;</span><span class="p">}},</span>
                   <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2013-01-01&quot;</span><span class="p">),</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">),</span> <span class="s2">&quot;keys&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">}]</span>
</pre></div>
</div>
<p>This would need to be mapped against the data ranges for the collected data sources (returned from search) - will likely need to update what the “keys” information here but this was just a placeholder. Note: that None meant there was no ranking information for that date range (but that’s ok as long as only 1 data source covers that time period).</p>
<p><em>(Need to be careful with start and end date inclusion but should be fine if we’re consistent…)</em></p>
</section>
<section id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this heading">#</a></h2>
<p>&gt; <strong>QUESTION:</strong> Do we want to add the rank associated with each piece of information or with a central data base? I think central database seems like it would make more sense e.g. csv / other form of database? How can we update this database? Using pandas or something else?</p>
<dl class="simple">
<dt>Extra columns added as needed depending on the ranks added? - always need “different”, “start_date” and “end_date”</dt><dd><ul class="simple">
<li><p>Would need to check if column already existed and if not add a column</p></li>
<li><p>Also need to check that the metadata key exists at all? Could we do this by checking against the metastore in some way?</p></li>
</ul>
</dd>
</dl>
<p>Stored csv (or otherwise):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">site</span><span class="p">,</span><span class="n">species</span><span class="p">,</span><span class="n">inlet</span><span class="p">,</span><span class="n">different</span><span class="p">,</span><span class="n">start_date</span><span class="p">,</span><span class="n">end_date</span>
<span class="n">tac</span><span class="p">,,</span><span class="mi">100</span><span class="n">m</span><span class="p">,</span><span class="n">inlet</span><span class="p">,,</span>
<span class="n">tac</span><span class="p">,</span><span class="n">co2</span><span class="p">,</span><span class="mi">10</span><span class="n">m</span><span class="p">,</span><span class="n">inlet</span><span class="p">,</span><span class="mi">2012</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
</pre></div>
</div>
<p>–&gt; DataFrame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">site</span>   <span class="n">species</span> <span class="n">inlet</span>   <span class="n">different</span>       <span class="n">start_date</span>      <span class="n">end_date</span>
<span class="n">tac</span>    <span class="n">NaN</span>     <span class="mi">100</span><span class="n">m</span>    <span class="n">inlet</span>           <span class="n">NaN</span>             <span class="n">NaN</span>
<span class="n">tac</span>    <span class="n">co2</span>     <span class="mi">10</span><span class="n">m</span>     <span class="n">inlet</span>           <span class="mi">2012</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>      <span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
</pre></div>
</div>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-current-ranks">
   Viewing current ranks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#updating-deleting-reordering-ranks">
   Updating / deleting (/reordering) ranks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-the-ranks">
   Using the ranks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code-design">
   Code design
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#database">
   Database
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2023 OpenGHG development team.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
  </footer>
  </body>
</html>