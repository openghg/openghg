
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Adding observation data &#8212; OpenGHG 0+untagged.1.gb7087df documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=db7899ab" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script src="../../../_static/documentation_options.js?v=bac506af"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/local/Adding_new_data/Adding_observation_data';</script>
    <script src="../../../_static/custom.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Adding ancillary spatial data" href="Adding_ancillary_data.html" />
    <link rel="prev" title="Tutorials" href="../../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/OpenGHG_Logo_NoText.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../../_static/OpenGHG_Logo_NoText.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index.html">
                        User API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../development/index_devel.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index_devapi.html">
                        Developer API
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index.html">
                        User API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../development/index_devel.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index_devapi.html">
                        Developer API
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Adding observation data</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Adding_ancillary_data.html">Adding ancillary spatial data</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Analysing_data/Comparing_with_emissions.html">Comparing observations to emissions</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Analysing_data/Working_with_co2.html">Working with carbon dioxide</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Exploring_data/Explore_NOAA_ObsPack.html">Explore NOAA ObsPack</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Exploring_data/Retrieving_remote_data.html">Retrieving data from remote archives</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Exploring_data/Searching_and_plotting.html">Searching and plotting</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Managing_object_store/Modifying_and_deleting_data.html">Modifying and deleting data</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Managing_object_store/Changing_object_store.html">Changing the object store path</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Adding observation data</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="adding-observation-data">
<span id="adding-obs-data"></span><h1>Adding observation data<a class="headerlink" href="#adding-observation-data" title="Link to this heading">#</a></h1>
<p>This tutorial demonstrates how OpenGHG can be used to process new
measurement data, search the data present and to retrieve this for
analysis and visualisation.</p>
<section id="using-the-tutorial-object-store">
<span id="id1"></span><h2>Using the tutorial object store<a class="headerlink" href="#using-the-tutorial-object-store" title="Link to this heading">#</a></h2>
<p>To avoid adding the example data we use in this tutorial to your normal
object store, we need to tell OpenGHG to use a separate sandboxed object
store that we’ll call the tutorial store. To do this we use the
<code class="docutils literal notranslate"><span class="pre">use_tutorial_store</span></code> function from <code class="docutils literal notranslate"><span class="pre">openghg.tutorial</span></code>. This sets the
<code class="docutils literal notranslate"><span class="pre">OPENGHG_TUT_STORE</span></code> environment variable for this session and won’t
affect your use of OpenGHG outside of this tutorial.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.tutorial</span> <span class="kn">import</span> <span class="n">use_tutorial_store</span>

<span class="n">use_tutorial_store</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="adding-and-standardising-data">
<h2>1. Adding and standardising data<a class="headerlink" href="#adding-and-standardising-data" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Outside of this tutorial, if you have write access to multiple object stores you
will need to pass the name of the object store you wish to write to to
the <code class="docutils literal notranslate"><span class="pre">store</span></code> argument of the standardise functions.</p>
</div>
<section id="source-formats">
<h3>Source formats<a class="headerlink" href="#source-formats" title="Link to this heading">#</a></h3>
<p>OpenGHG can process and store several source formats in the object store,
including data from the AGAGE, DECC, NOAA, LondonGHG, BEAC2ON networks.
The process of adding data to the object store is called <em>standardisation</em>.</p>
<p>To standardise a new data file, you must specify the <em>source format</em> and
other details about the data.
For the full list of accepted observation inputs and source formats, call
the function <code class="docutils literal notranslate"><span class="pre">summary_source_formats</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">openghg.standardise</span> <span class="kn">import</span> <span class="n">summary_source_formats</span>

<span class="gp">In [2]: </span><span class="n">summary</span> <span class="o">=</span> <span class="n">summary_source_formats</span><span class="p">()</span>

<span class="go">## UNCOMMENT THIS CODE TO SHOW ALL ENTRIES</span>
<span class="go"># import pandas as pd; pd.set_option(&#39;display.max_rows&#39;, None)</span>
<span class="gp">In [3]: </span><span class="n">summary</span>
<span class="gh">Out[3]: </span>
<span class="go">     Source format Site code  ...                     Long name      Platform</span>
<span class="go">0              BTT       BTT  ...                  BT Tower, UK  surface site</span>
<span class="go">1             CRDS       RPB  ...        Ragged Point, Barbados  surface site</span>
<span class="go">2             CRDS       HFD  ...                Heathfield, UK  surface site</span>
<span class="go">3             CRDS       BSD  ...                  Bilsdale, UK  surface site</span>
<span class="go">4             CRDS       TTA  ...               Angus Tower, UK  surface site</span>
<span class="go">..             ...       ...  ...                           ...           ...</span>
<span class="go">317           NOAA       YON  ...           Yonagunijima, Japan  surface site</span>
<span class="go">318           NOAA       ZEP  ...  Zeppelin, Ny Alesund, Norway  surface site</span>
<span class="go">319  THAMESBARRIER       TMB  ...            Thames Barrier, UK  surface site</span>
<span class="go">320      CRANFIELD       TMB  ...            Thames Barrier, UK  surface site</span>
<span class="go">321            NPL       NPL  ...  National Physical Laboratory  surface site</span>

<span class="go">[322 rows x 7 columns]</span>
</pre></div>
</div>
<p>There may be multiple source formats for a given site.
For instance, the Tacolneston site in the UK (site code “TAC”) has four entries:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">summary</span><span class="p">[</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;Site code&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;TAC&quot;</span><span class="p">]</span>
<span class="gh">Out[4]: </span>
<span class="go">    Source format Site code  ...              Long name      Platform</span>
<span class="go">6            CRDS       TAC  ...  Tacolneston Tower, UK  surface site</span>
<span class="go">33        GCWERKS       TAC  ...  Tacolneston Tower, UK  surface site</span>
<span class="go">35        GCWERKS       TAC  ...  Tacolneston Tower, UK  surface site</span>
<span class="go">279          NOAA       TAC  ...  Tacolneston Tower, UK  surface site</span>

<span class="go">[4 rows x 7 columns]</span>
</pre></div>
</div>
</section>
<section id="decc-network">
<h3>DECC network<a class="headerlink" href="#decc-network" title="Link to this heading">#</a></h3>
<p>We will start by adding data to the object store from Tacolneston, which is a <em>surface site</em>
in the DECC network. (Data at surface sites is measured in-situ.)</p>
<p>First we retrieve the raw data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.tutorial</span> <span class="kn">import</span> <span class="n">retrieve_example_data</span>

<span class="n">data_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/openghg/example_data/raw/main/timeseries/tac_example.tar.gz&quot;</span>

<span class="n">tac_data</span> <span class="o">=</span> <span class="n">retrieve_example_data</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">data_url</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we add this data to the object store using <code class="docutils literal notranslate"><span class="pre">standardise_surface</span></code>, passing the
following arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filepaths</span></code>: list of paths to <code class="docutils literal notranslate"><span class="pre">.dat</span></code> files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">site</span></code>:  <code class="docutils literal notranslate"><span class="pre">&quot;TAC&quot;</span></code>, the site code for Tacolneston</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source_format</span></code>: <code class="docutils literal notranslate"><span class="pre">&quot;CRDS&quot;</span></code>, the type of data we want to process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">network</span></code>: <code class="docutils literal notranslate"><span class="pre">&quot;DECC&quot;</span></code></p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="kn">from</span> <span class="nn">openghg.standardise</span> <span class="kn">import</span> <span class="n">standardise_surface</span>

<span class="gp">In [6]: </span><span class="n">decc_results</span> <span class="o">=</span> <span class="n">standardise_surface</span><span class="p">(</span><span class="n">filepaths</span><span class="o">=</span><span class="n">tac_data</span><span class="p">,</span> <span class="n">source_format</span><span class="o">=</span><span class="s2">&quot;CRDS&quot;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s2">&quot;TAC&quot;</span><span class="p">,</span> <span class="n">network</span><span class="o">=</span><span class="s2">&quot;DECC&quot;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">decc_results</span>
<span class="gh">Out[7]: </span><span class="go">{&#39;processed&#39;: {&#39;tac.picarro.hourly.54m.dat&#39;: {&#39;ch4&#39;: {&#39;uuid&#39;: &#39;e2339fdf-c0d5-46b8-b5b9-3d682610e9fe&#39;, &#39;new&#39;: True}, &#39;co2&#39;: {&#39;uuid&#39;: &#39;1b4603e6-cac2-458c-b47e-e441864b29eb&#39;, &#39;new&#39;: True}},</span>
<span class="go">&#39;tac.picarro.hourly.100m.dat&#39;: {&#39;ch4&#39;: {&#39;uuid&#39;: &#39;2e5935cc-07e3-4c0f-bd7c-8c6e4e2b13b7&#39;, &#39;new&#39;: True}, &#39;co2&#39;: {&#39;uuid&#39;: &#39;64c020b8-35dd-483f-b38c-99de83ea412d&#39;, &#39;new&#39;: True}},</span>
<span class="go">&#39;tac.picarro.hourly.185m.dat&#39;: {&#39;ch4&#39;: {&#39;uuid&#39;: &#39;13172db7-7859-4f38-90cf-219c1fbe3b99&#39;, &#39;new&#39;: True}, &#39;co2&#39;: {&#39;uuid&#39;: &#39;c79a3473-9f50-47d8-83d8-66a62fd085f7&#39;, &#39;new&#39;: True}}}}</span>
</pre></div>
</div>
<p>This extracts the data and metadata from the files,
standardises them, and adds them to our object store.</p>
<p>The returned <code class="docutils literal notranslate"><span class="pre">decc_results</span></code> dictionary shows how the data
has been stored: each file has been split into several entries, each with a unique ID (UUID).
Each entry is known as a <em>Datasource</em> (see <a class="reference internal" href="#note-on-datasources"><span class="std std-ref">Note on Datasources</span></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">decc_results</span></code> output includes details of the processed data and tells
us that the data has been stored correctly. This will also tell us if
any errors have been encountered when trying to access and standardise
this data.</p>
</section>
<section id="multiple-stores">
<h3>Multiple stores<a class="headerlink" href="#multiple-stores" title="Link to this heading">#</a></h3>
<p>If you have write access to more than one object store you’ll need to pass in the name of that store
to the <code class="docutils literal notranslate"><span class="pre">store</span></code> argument.
So instead of the standardise_surface call above, we’ll tell it to write to our default <code class="docutils literal notranslate"><span class="pre">user</span></code> object store. This is our default local object store
created when we run <code class="docutils literal notranslate"><span class="pre">openghg</span> <span class="pre">--quickstart</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.standardise</span> <span class="kn">import</span> <span class="n">standardise_surface</span>

<span class="n">decc_results</span> <span class="o">=</span> <span class="n">standardise_surface</span><span class="p">(</span><span class="n">filepaths</span><span class="o">=</span><span class="n">tac_data</span><span class="p">,</span> <span class="n">source_format</span><span class="o">=</span><span class="s2">&quot;CRDS&quot;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s2">&quot;TAC&quot;</span><span class="p">,</span> <span class="n">network</span><span class="o">=</span><span class="s2">&quot;DECC&quot;</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">store</span></code> argument can be passed to any of the <code class="docutils literal notranslate"><span class="pre">standardise</span></code> functions in OpenGHG and is required if you have write access
to more than one store.</p>
</section>
<section id="agage-data">
<h3>AGAGE data<a class="headerlink" href="#agage-data" title="Link to this heading">#</a></h3>
<p>OpenGHG can also process data from the <a class="reference external" href="https://agage.mit.edu/">AGAGE network</a>.</p>
<p>The functions that process the AGAGE data expect data to have an
accompanying <em>precisions file</em>. For each data file we create a tuple with
the data filename and the precisions filename.</p>
<p>First we retrieve example data from the  Cape Grim station in Australia (site code “CGO””).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cgo_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/openghg/example_data/raw/main/timeseries/capegrim_example.tar.gz&quot;</span>

<span class="n">capegrim_data</span> <span class="o">=</span> <span class="n">retrieve_example_data</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">cgo_url</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">capegrim_data</span></code> is a list of two file paths, one for the data file and one for the precisions file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">PosixPath</span><span class="p">(</span><span class="s1">&#39;/Users/bm13805/openghg_store/tutorial_store/extracted_files/capegrim.18.C&#39;</span><span class="p">),</span>
<span class="n">PosixPath</span><span class="p">(</span><span class="s1">&#39;/Users/bm13805/openghg_store/tutorial_store/extracted_files/capegrim.18.precisions.C&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>We put the data file and precisions file into a tuple:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">capegrim_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">capegrim_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">capegrim_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>We can add these files to the object store in the same way as the DECC
data by including the right arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filepaths</span></code>: tuple (or list of tuples) with paths to data and precision files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">site</span></code> (site code): <code class="docutils literal notranslate"><span class="pre">&quot;CGO&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source_format</span></code> (data type): <code class="docutils literal notranslate"><span class="pre">&quot;GCWERKS&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">network</span></code>: <code class="docutils literal notranslate"><span class="pre">&quot;AGAGE&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">instrument</span></code>: <code class="docutils literal notranslate"><span class="pre">&quot;medusa&quot;</span></code></p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agage_results</span> <span class="o">=</span> <span class="n">standardise_surface</span><span class="p">(</span><span class="n">filepaths</span><span class="o">=</span><span class="n">capegrim_tuple</span><span class="p">,</span> <span class="n">source_format</span><span class="o">=</span><span class="s2">&quot;GCWERKS&quot;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s2">&quot;CGO&quot;</span><span class="p">,</span>
                              <span class="n">network</span><span class="o">=</span><span class="s2">&quot;AGAGE&quot;</span><span class="p">,</span> <span class="n">instrument</span><span class="o">=</span><span class="s2">&quot;medusa&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>When viewing <code class="docutils literal notranslate"><span class="pre">agage_results</span></code> there will be a large number of
Datasource UUIDs shown due to the large number of gases in each data
file</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">agage_results</span>
<span class="gh">Out[8]: </span>
<span class="go">{&#39;processed&#39;: {&#39;capegrim.18.C&#39;: {&#39;ch4_70m&#39;: {&#39;uuid&#39;: &#39;200d8a1b-bc41-4f9f-86c4-448c2427d780&#39;,</span>
<span class="go">&#39;new&#39;: True},</span>
<span class="go">&#39;cfc12_70m&#39;: {&#39;uuid&#39;: &#39;e507358e-ade3-4c83-914e-e486628640ce&#39;, &#39;new&#39;: True},</span>
<span class="go">&#39;n2o_70m&#39;: {&#39;uuid&#39;: &#39;ad381148-76af-4d8c-aaec-f7cc2a0088b7&#39;, &#39;new&#39;: True},</span>
<span class="go">&#39;cfc11_70m&#39;: {&#39;uuid&#39;: &#39;2563a11b-2a54-4287-8705-670f34330e33&#39;, &#39;new&#39;: True},</span>
<span class="go">&#39;cfc113_70m&#39;: {&#39;uuid&#39;: &#39;6a6e28d9-4242-4c6f-a71a-0d56915a485b&#39;, &#39;new&#39;: True},</span>
<span class="go">&#39;chcl3_70m&#39;: {&#39;uuid&#39;: &#39;36af68d9-f421-4feb-9bfd-c719ec603f05&#39;, &#39;new&#39;: True},</span>
<span class="go">&#39;ch3ccl3_70m&#39;: {&#39;uuid&#39;: &#39;f096f4c3-e86f-4d99-8a92-e35dd193cfbc&#39;,</span>
<span class="go">&#39;new&#39;: True},</span>
<span class="go">&#39;ccl4_70m&#39;: {&#39;uuid&#39;: &#39;396be43c-f29a-408e-9a88-c16ffd79da3b&#39;, &#39;new&#39;: True},</span>
<span class="go">&#39;h2_70m&#39;: {&#39;uuid&#39;: &#39;62045a91-bac9-4b7d-84b8-696ec8484002&#39;, &#39;new&#39;: True},</span>
<span class="go">&#39;co_70m&#39;: {&#39;uuid&#39;: &#39;a1bd7ab9-4ae0-46aa-8570-ec961f929431&#39;, &#39;new&#39;: True},</span>
<span class="go">&#39;ne_70m&#39;: {&#39;uuid&#39;: &#39;950e94fe-6cf9-48e3-b920-275935761885&#39;, &#39;new&#39;: True}}}}</span>
</pre></div>
</div>
<section id="note-on-datasources">
<span id="id2"></span><h4>Note on Datasources<a class="headerlink" href="#note-on-datasources" title="Link to this heading">#</a></h4>
<p>Datasources are objects that are stored in the object store (++add link
to object store notes++) that hold the data and metadata associated with
each measurement we upload to the platform.</p>
<p>For example, if we upload a file that contains readings for three gas
species from a single site at a specific inlet height OpenGHG will
assign this data to three different Datasources, one for each species.
Metadata such as the site, inlet height, species, network etc are stored
alongside the measurements for easy searching.</p>
<p>Datasources can also handle multiple versions of data from a single
site, so if scales or other factors change multiple versions may be
stored for easy future comparison.</p>
</section>
</section>
</section>
<section id="searching-for-data">
<h2>3. Searching for data<a class="headerlink" href="#searching-for-data" title="Link to this heading">#</a></h2>
<section id="searching-the-object-store">
<h3>Searching the object store<a class="headerlink" href="#searching-the-object-store" title="Link to this heading">#</a></h3>
<p>We can search the object store by property using the
<code class="docutils literal notranslate"><span class="pre">search_surface(...)</span></code> function.</p>
<p>For example we can find all sites which have measurements for carbon
tetrafluoride (“cf4”) using the <code class="docutils literal notranslate"><span class="pre">species</span></code> keyword:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.retrieve</span> <span class="kn">import</span> <span class="n">search_surface</span>

<span class="n">cfc_results</span> <span class="o">=</span> <span class="n">search_surface</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="s2">&quot;cfc11&quot;</span><span class="p">)</span>
<span class="n">cfc_results</span>
</pre></div>
</div>
<p>We could also look for details of all the data measured at the Tacolneston
(“TAC”) site using the <code class="docutils literal notranslate"><span class="pre">site</span></code> keyword:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tac_results</span> <span class="o">=</span> <span class="n">search_surface</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="s2">&quot;tac&quot;</span><span class="p">)</span>
<span class="n">tac_results</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tac_results</span><span class="o">.</span><span class="n">results</span>
</pre></div>
</div>
<p>For this site you can see this contains details of each of the species
as well as the inlet heights these were measured at.</p>
</section>
<section id="quickly-retrieve-data">
<h3>Quickly retrieve data<a class="headerlink" href="#quickly-retrieve-data" title="Link to this heading">#</a></h3>
<p>Say we want to retrieve all the <code class="docutils literal notranslate"><span class="pre">co2</span></code> data from Tacolneston, we can
perform perform a search and expect a <a class="reference external" href="https://docs.openghg.org/api/api_dataobjects.html#openghg.dataobjects.SearchResult"><code class="docutils literal notranslate"><span class="pre">SearchResults</span></code></a>
object to be returned. If no results are found <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">search_surface</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="s2">&quot;tac&quot;</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s2">&quot;co2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">results</span>
</pre></div>
</div>
<p>We can retrieve either some or all of the data easily using the
<code class="docutils literal notranslate"><span class="pre">retrieve</span></code> function.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inlet_54m_data</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">inlet</span><span class="o">=</span><span class="s2">&quot;54m&quot;</span><span class="p">)</span>
<span class="n">inlet_54m_data</span>
</pre></div>
</div>
<p>Or we can retrieve all of the data and get a list of <code class="docutils literal notranslate"><span class="pre">ObsData</span></code>
objects.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_co2_data</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">retrieve_all</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_co2_data</span>
</pre></div>
</div>
</section>
</section>
<section id="retrieving-data">
<h2>4. Retrieving data<a class="headerlink" href="#retrieving-data" title="Link to this heading">#</a></h2>
<p>To retrieve the standardised data from the object store there are
several functions we can use which depend on the type of data we want to
access.</p>
<p>To access the surface data we have added so far we can use the
<code class="docutils literal notranslate"><span class="pre">get_obs_surface</span></code> function and pass keywords for the site code,
species and inlet height to retrieve our data.</p>
<p>In this case we want to extract the carbon dioxide (“co2”) data from the
Tacolneston data (“TAC”) site measured at the “185m” inlet:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.retrieve</span> <span class="kn">import</span> <span class="n">get_obs_surface</span>

<span class="n">co2_data</span> <span class="o">=</span> <span class="n">get_obs_surface</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="s2">&quot;tac&quot;</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s2">&quot;co2&quot;</span><span class="p">,</span> <span class="n">inlet</span><span class="o">=</span><span class="s2">&quot;185m&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If we view our returned <code class="docutils literal notranslate"><span class="pre">obs_data</span></code> variable this will contain:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> - The standardised data (accessed using
e.g. <code class="docutils literal notranslate"><span class="pre">obs_data.data</span></code>). This is returned as an <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.Dataset.html">xarray
Dataset</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metadata</span></code> - The associated metadata (accessed using
e.g. <code class="docutils literal notranslate"><span class="pre">obs_data.metadata</span></code>).</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_data</span>
</pre></div>
</div>
<p>We can now make a simple plot using the <code class="docutils literal notranslate"><span class="pre">plot_timeseries</span></code> method of
the <code class="docutils literal notranslate"><span class="pre">ObsData</span></code> object.</p>
<blockquote>
<div><p><strong>NOTE:</strong> the plot created below may not show up on the online
documentation version of this notebook.</p>
</div></blockquote>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_data</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also pass any of <code class="docutils literal notranslate"><span class="pre">title</span></code>, <code class="docutils literal notranslate"><span class="pre">xlabel</span></code>, <code class="docutils literal notranslate"><span class="pre">ylabel</span></code> and <code class="docutils literal notranslate"><span class="pre">units</span></code>
to the <code class="docutils literal notranslate"><span class="pre">plot_timeseries</span></code> function to modify the labels.</p>
</section>
<section id="cleanup">
<h2>5. Cleanup<a class="headerlink" href="#cleanup" title="Link to this heading">#</a></h2>
<p>If you’re finished with the data in this tutorial you can cleanup the
tutorial object store using the <code class="docutils literal notranslate"><span class="pre">clear_tutorial_store</span></code> function.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.tutorial</span> <span class="kn">import</span> <span class="n">clear_tutorial_store</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clear_tutorial_store</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../../index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorials</p>
      </div>
    </a>
    <a class="right-next"
       href="Adding_ancillary_data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Adding ancillary spatial data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-tutorial-object-store">Using the tutorial object store</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-and-standardising-data">1. Adding and standardising data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-formats">Source formats</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decc-network">DECC network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-stores">Multiple stores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agage-data">AGAGE data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#note-on-datasources">Note on Datasources</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-data">3. Searching for data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-the-object-store">Searching the object store</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quickly-retrieve-data">Quickly retrieve data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieving-data">4. Retrieving data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleanup">5. Cleanup</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023 OpenGHG development team.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>