
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Adding ancillary spatial data &#8212; OpenGHG 0.8.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=db7899ab" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=486e5634"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/local/Adding_data/Adding_ancillary_data';</script>
    <script src="../../../_static/custom.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Using databases to add data" href="Creating_data_from_databases.html" />
    <link rel="prev" title="Adding observation data" href="Adding_observation_data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Mar 19, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/OpenGHG_Logo_NoText.png" class="logo__image only-light" alt="OpenGHG 0.8.0 documentation - Home"/>
    <script>document.write(`<img src="../../../_static/OpenGHG_Logo_NoText.png" class="logo__image only-dark" alt="OpenGHG 0.8.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index.html">
                        User API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../development/index_devel.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index_devapi.html">
                        Developer API
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index.html">
                        User API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../development/index_devel.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../api/index_devapi.html">
                        Developer API
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Adding_observation_data.html">Adding observation data</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Adding ancillary spatial data</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Creating_data_from_databases.html">Using databases to add data</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Metadata_and_attributes.html">Metadata and attributes</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Updating_existing_data.html">Updating existing data</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Analysing_data/Comparing_with_emissions.html">Comparing observations to emissions</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Analysing_data/Working_with_co2.html">Working with carbon dioxide</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Exploring_data/Explore_NOAA_ObsPack.html">Explore NOAA ObsPack</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Exploring_data/Retrieving_remote_data.html">Retrieving data from remote archives</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Exploring_data/Searching_and_plotting.html">Searching and plotting</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Managing_object_store/Changing_object_store.html">Changing the object store path</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Adding...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="adding-ancillary-spatial-data">
<h1>Adding ancillary spatial data<a class="headerlink" href="#adding-ancillary-spatial-data" title="Link to this heading">#</a></h1>
<p>This tutorial demonstrates how to add ancillary spatial data to the
OpenGHG store. These are split into several data types which currently
include:</p>
<ul class="simple">
<li><p>“footprints”: regional outputs from an LPDM model <a class="footnote-reference brackets" href="#f3" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> (e.g. NAME).
The LPDM set up for these outputs is based on e.g. <em class="xref py py-obj">Lunt et al. 2016</em></p></li>
<li><p>“flux”: estimates of species flux/emissions <a class="footnote-reference brackets" href="#f2" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> within a region</p></li>
<li><p>“boundary_conditions”: vertical curtains at the boundary of a
regional domain</p></li>
<li><p>“eulerian_model”: Global CTM output (e.g. GEOSChem) <a class="footnote-reference brackets" href="#f1" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p></li>
</ul>
<p>These inputs must adhere to an expected <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">netCDF</a>
format with a minimum fixed set of inputs (see <a class="reference internal" href="#input-format"><span class="std std-ref">below</span></a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For some often used databases and inputs, there will be limited
transformation functions available to create and store data in this
format directly. See the <a class="reference external" href="https://docs.openghg.org/api/api_transform.html"><code class="docutils literal notranslate"><span class="pre">openghg.transform</span></code></a> sub-module for options.</p>
</div>
<section id="using-the-tutorial-object-store">
<h2>Using the tutorial object store<a class="headerlink" href="#using-the-tutorial-object-store" title="Link to this heading">#</a></h2>
<p>As in the <a class="reference internal" href="Adding_observation_data.html#using-the-tutorial-object-store"><span class="std std-ref">previous tutorial</span></a>,
we will use the tutorial object store to avoid cluttering your personal
object store.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.tutorial</span> <span class="kn">import</span> <span class="n">use_tutorial_store</span>

<span class="n">use_tutorial_store</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="adding-and-standardising-data">
<h2>1. Adding and standardising data<a class="headerlink" href="#adding-and-standardising-data" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Outside of this tutorial, if you have write access to multiple object stores you
will need to pass the name of the object store you wish to write to to
the <code class="docutils literal notranslate"><span class="pre">store</span></code> argument of the standardise functions.</p>
</div>
<p>Data can be added to the object store using appropriate functions from
the <code class="docutils literal notranslate"><span class="pre">openghg.standardise</span></code> sub module. This includes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">standardise_footprints</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">standardise_flux</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">standardise_bc</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">standardise_eulerian</span></code> <a class="footnote-reference brackets" href="#f1" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p></li>
</ul>
<p>For all data types, a set of keywords should be supplied in addition
to the path to the data file.
These keywords depend on the data type; they are
used to categorise the data.</p>
<p>We can grab some data which is in the <a class="reference internal" href="#input-format"><span class="std std-ref">expected format</span></a>
for our different types so these can be added to the object store.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.tutorial</span> <span class="kn">import</span> <span class="n">retrieve_example_data</span>

<span class="n">fp_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/openghg/example_data/raw/main/footprint/tac_footprint_inert_201607.tar.gz&quot;</span>
<span class="n">data_file_fp</span> <span class="o">=</span> <span class="n">retrieve_example_data</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">fp_url</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">flux_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/openghg/example_data/raw/main/flux/ch4-ukghg-all_EUROPE_2016.tar.gz&quot;</span>
<span class="n">data_file_flux</span> <span class="o">=</span> <span class="n">retrieve_example_data</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">flux_url</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">bc_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/openghg/example_data/raw/main/boundary_conditions/ch4_EUROPE_201607.tar.gz&quot;</span>
<span class="n">data_file_bc</span> <span class="o">=</span> <span class="n">retrieve_example_data</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">bc_url</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Downloading tac_footprint_inert_201607.tar.gz: 100%|██████████| 67.0M/67.0M [00:17&lt;00:00, 3.95MB/s]
Downloading ch4-ukghg-all_EUROPE_2016.tar.gz: 100%|██████████| 82.5k/82.5k [00:00&lt;00:00, 2.38MB/s]
Downloading ch4_EUROPE_201607.tar.gz: 100%|██████████| 77.4k/77.4k [00:00&lt;00:00, 4.22MB/s]
</pre></div>
</div>
<section id="data-domains">
<h3>Data domains<a class="headerlink" href="#data-domains" title="Link to this heading">#</a></h3>
<p>For spatial data, a <em>domain</em> label indicates consistent areas and resolution.
For multiple pieces of data, a single domain name should refer to the exact
same set of latitude and longitude bounds.</p>
<p>Pre-defined domains can be listed as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.util</span> <span class="kn">import</span> <span class="n">get_domain_info</span>

<span class="n">get_domain_info</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also add new domain labels and definitions as needed.</p>
<section id="footprints">
<h4>Footprints<a class="headerlink" href="#footprints" title="Link to this heading">#</a></h4>
<p>To standardise <a class="footnote-reference brackets" href="#f4" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> footprint data, we pass the following arguments to
<code class="docutils literal notranslate"><span class="pre">standardise_footprint</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filepath</span></code>: path to footprint file (this is the first positional argument)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">site</span></code>: site identifier (use <code class="docutils literal notranslate"><span class="pre">openghg.standardise.summary_site_codes()</span></code> function to check this)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inlet</span></code>: inlet height associated with the site</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code>: regional domain covered by the footprint</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">model</span></code>: name of model used to create the footprint</p></li>
</ul>
<p>Additional details can also be specified, in particular, for the
meteorological model used (met_model) and the species name (if relevant).</p>
<p>For the example below, the footprint data generated from the NAME model
for the Tacolneston (TAC) site at 100m inlet. This covers an area over
Europe which we have defined as the “EUROPE” domain. Unless a specific
species is specified, this will be assumed to be a generic inert
species.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.standardise</span> <span class="kn">import</span> <span class="n">standardise_footprint</span>

<span class="n">standardise_footprint</span><span class="p">(</span><span class="n">data_file_fp</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s2">&quot;TAC&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">,</span> <span class="n">inlet</span><span class="o">=</span><span class="s2">&quot;100m&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;NAME&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WARNING</span><span class="p">:</span><span class="n">openghg</span><span class="o">.</span><span class="n">store</span><span class="p">:</span><span class="n">This</span> <span class="n">file</span> <span class="n">has</span> <span class="n">been</span> <span class="n">uploaded</span> <span class="n">previously</span> <span class="k">with</span> <span class="n">the</span> <span class="n">filename</span> <span class="p">:</span> <span class="n">TAC</span><span class="o">-</span><span class="mi">100</span><span class="n">magl_UKV_EUROPE_201607</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span> <span class="n">skipping</span><span class="o">.</span>
</pre></div>
</div>
<p>This standardised data can then be accessed and retrieved from the
object store using the <code class="docutils literal notranslate"><span class="pre">get_footprint</span></code> function available from the
<code class="docutils literal notranslate"><span class="pre">openghg.retrieve</span></code> submodule.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.retrieve</span> <span class="kn">import</span> <span class="n">get_footprint</span>

<span class="n">footprint_data</span> <span class="o">=</span> <span class="n">get_footprint</span><span class="p">(</span><span class="n">site</span><span class="o">=</span><span class="s2">&quot;TAC&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">,</span> <span class="n">inlet</span><span class="o">=</span><span class="s2">&quot;100m&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For the standards associated the footprint files, there are also flags
which can be passed to sub-categorise the footprint inputs: -
<code class="docutils literal notranslate"><span class="pre">high_spatial_resolution</span></code> - footprints containing multiple spatial
resolutions. This is usually an embedded high resolution region within a
larger lower resolution domain. - <code class="docutils literal notranslate"><span class="pre">high_time_resolution</span></code> - footprints which
include an additional dimension for resolving on the time axis. This is
associated with shorter term flux changes (e.g. natural sources of
carbon dioxide). A species will normally be associated with this
footprint (e.g. “co2”). - <code class="docutils literal notranslate"><span class="pre">short_lifetime</span></code> - footprints for species
with a shorter lifetime (&lt;30 days). An explicit species input should be
associated with this footprint as well.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">high_spatial_res</span></code>: footprints containing multiple spatial resolutions.
This is usually an embedded high resolution region within a larger lower
resolution domain.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">high_time_res</span></code>: footprints which include an additional dimension for
resolving on the time axis. This is associated with shorter term flux
changes (e.g. natural sources of carbon dioxide). A species will normally
be associated with this footprint (e.g. “co2”).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">short_lifetime</span></code>: footprints for species with a shorter lifetime (less
than 30 days). An explicit species input should be associated with this
footprint as well.</p></li>
</ul>
<p>If possible, <code class="docutils literal notranslate"><span class="pre">standardise_footprint</span></code> will attempt to infer these
details, but they should be supplied to ensure the footprint data is
labelled correctly.
See schema details below for how these inputs are defined.</p>
</section>
<section id="chunking">
<h4>Chunking<a class="headerlink" href="#chunking" title="Link to this heading">#</a></h4>
<p>When reading in a netCDF file for standardisation we can pass a dictionary of chunk sizes to the standardisation function.
This is useful for large files as it can reduce memory usage and speed up the process.</p>
<section id="default-chunking">
<h5>Default chunking<a class="headerlink" href="#default-chunking" title="Link to this heading">#</a></h5>
<p>If you don’t specify chunk sizes OpenGHG will use a default chunking schema for the the data type. For footprints the chunking scheme used will depend on the properties of the footprint, such as whether it is a high time resolution CO2 footprint, a high spatial resolution footprint or a short lifetime species footprint. The default chunking scheme is designed to be a good compromise between memory usage and speed. If you’re unsure what chunk sizes to use then it’s best to leave the chunking to OpenGHG.</p>
</section>
<section id="manual-chunking">
<h5>Manual chunking<a class="headerlink" href="#manual-chunking" title="Link to this heading">#</a></h5>
<p>As a rule of thumb aim for chunk sizes of 100 - 300 MB in size. The best chunk size for you will depend on the memory of the system you’re running the standardisation process on and how you’ll be retrieving using the data from the object store. In this example we’ll standardise a high time resolution CO2 footprint dataset and tell OpenGHG to
chunk the file into chunks of 24 time points.</p>
<p>Let’s perform a quick calculation of the chunk sizes for the CO2 footprint dataset. As the variable <em class="xref py py-obj">fp_HiTRes</em> is has an extra <em class="xref py py-obj">H_back</em> dimension we’ll calculate the chunk sizes for this variable.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="gp">In [2]: </span><span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s2">&quot;TAC-185magl_UKV_co2_EUROPE_201501.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ds</span><span class="p">:</span>
<span class="go">  ...:     var_dtype = ds.fp_HiTRes.dtype</span>
<span class="go">  ...:     var_dims = ds.fp_HiTRes.sizes</span>
<span class="go">  ...:</span>

<span class="gp">In [3]: </span><span class="n">var_dims</span>
<span class="gh">Out[3]: </span><span class="go">Frozen({&#39;lat&#39;: 293, &#39;lon&#39;: 391, &#39;time&#39;: 744, &#39;H_back&#39;: 25})</span>

<span class="gp">In [4]: </span><span class="n">var_dtype</span>
<span class="gh">Out[4]: </span><span class="go">dtype(&#39;float32&#39;)</span>

<span class="gp">In [5]: </span><span class="n">var_dtype</span><span class="o">.</span><span class="n">itemsize</span>
<span class="gh">Out[5]: </span><span class="go">4</span>
</pre></div>
</div>
<p>Now we’ve got the sizes of the dimensions and the data type (32-bit floats so 4 bytes per value) of the variable we can calculate the size of the chunks in bytes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">chunk_size</span> <span class="o">=</span> <span class="mi">24</span>

<span class="gp">In [6]: </span><span class="n">chunk_bytes</span> <span class="o">=</span> <span class="n">chunk_size</span> <span class="o">*</span> <span class="n">var_dtype</span><span class="o">.</span><span class="n">itemsize</span> <span class="o">*</span> <span class="n">var_dims</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">var_dims</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">var_dims</span><span class="p">[</span><span class="s1">&#39;H_back&#39;</span><span class="p">]</span>

<span class="gp">In [7]: </span><span class="n">chunk_MBs</span> <span class="o">=</span> <span class="n">chunk_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">chunk_MBs</span>
<span class="gh">Out[7]: </span><span class="go">262.2138977050781</span>
</pre></div>
</div>
<p>So we’ve got chunk sizes of 262 MB which seems sensible. Let’s pass this to the standardisation function using the <em class="xref py py-obj">chunks</em> argument.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="kn">from</span> <span class="nn">openghg.standardise</span> <span class="kn">import</span> <span class="n">standardise_footprint</span>

<span class="gp">In [9]: </span><span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">}</span>

<span class="gp">In [10]: </span><span class="n">standardise_footprint</span><span class="p">(</span><span class="n">data_file_fp</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s2">&quot;TAC&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">,</span> <span class="n">inlet</span><span class="o">=</span><span class="s2">&quot;100m&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s2">&quot;co2&quot;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">)</span>
</pre></div>
</div>
<p>Try different chunk sizes to see what works best for your system.</p>
</section>
</section>
<section id="flux-emissions">
<h4>Flux / Emissions<a class="headerlink" href="#flux-emissions" title="Link to this heading">#</a></h4>
<p>Flux/emissions data typically describes “prior guesses” for emissions
of substances, often broken down by region and source of emission.</p>
<p>To  standardise flux/emissions data <a class="footnote-reference brackets" href="#f2" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> we pass the following arguments
to <code class="docutils literal notranslate"><span class="pre">standardise_flux</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filepath</span></code>: path to footprint file (this is the first positional argument)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">species</span></code>: a name for the associated species</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code>: the regional domain covered by the flux data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>: a name for the source of that data.</p></li>
</ul>
<p>Additional optional identifiers include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">database</span></code>: inventory/database name associated with the flux data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">database_version</span></code>: if a database is specified, a version should
be included as well</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">model</span></code>: the name of the model used to generate the flux data</p></li>
</ul>
<p>For the example below, the flux data is for methane (“ch4”) and is covered
by the same “EUROPE” domain as the footprint data described above.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.standardise</span> <span class="kn">import</span> <span class="n">standardise_flux</span>

<span class="n">standardise_flux</span><span class="p">(</span><span class="n">data_file_flux</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s2">&quot;ch4&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;anthro&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ukghg&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once the raw flux data is standardised, we can retrieve it from the object store:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.retrieve</span> <span class="kn">import</span> <span class="n">get_flux</span>

<span class="n">flux_data</span> <span class="o">=</span> <span class="n">get_flux</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="s2">&quot;ch4&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;anthro&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="boundary-conditions">
<h4>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading">#</a></h4>
<p>Boundary conditions describe the vertical curtains of a
regional domain.</p>
<p>To  standardise boundary conditions data we pass the following arguments
to <code class="docutils literal notranslate"><span class="pre">standardise_bc</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filepath</span></code>: path to footprint file (this is the first positional argument)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">species</span></code>: a name for the associated species</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code>: the name of the domain the vertical curtains surround</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bc_input</span></code>: a keyword descriptor for the boundary conditions inputs used</p></li>
</ul>
<p>For the example below, the boundary conditions are for methane (“ch4”)
at the edges of the “EUROPE” domain. They were created using the <a class="reference external" href="https://www.ecmwf.int/en/newsletter/163/news/ecmwf-helps-users-drive-regional-chemistry-model-cams-data">CAMS climatology product</a> <a class="footnote-reference brackets" href="#f5" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.standardise</span> <span class="kn">import</span> <span class="n">standardise_bc</span>

<span class="n">standardise_bc</span><span class="p">(</span><span class="n">data_file_bc</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s2">&quot;ch4&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">,</span> <span class="n">bc_input</span><span class="o">=</span><span class="s2">&quot;CAMS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WARNING</span><span class="p">:</span><span class="n">openghg</span><span class="o">.</span><span class="n">store</span><span class="p">:</span><span class="n">This</span> <span class="n">file</span> <span class="n">has</span> <span class="n">been</span> <span class="n">uploaded</span> <span class="n">previously</span> <span class="k">with</span> <span class="n">the</span> <span class="n">filename</span> <span class="p">:</span> <span class="n">ch4_EUROPE_201607</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span> <span class="n">skipping</span><span class="o">.</span>
</pre></div>
</div>
</section>
</section>
<section id="user-defined-keywords-source-and-bc-input">
<h3>User defined keywords: <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">bc_input</span></code><a class="headerlink" href="#user-defined-keywords-source-and-bc-input" title="Link to this heading">#</a></h3>
<p>Unlike the <code class="docutils literal notranslate"><span class="pre">domain</span></code> and <code class="docutils literal notranslate"><span class="pre">species</span></code> inputs which have some pre-defined
values, the <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">bc_input</span></code> keywords can be chosen by the
user as a way to describe the flux and boundary condition inputs,
alongside the additional optional values.</p>
<p>However, once a convention is chosen for a given <code class="docutils literal notranslate"><span class="pre">source</span></code> or <code class="docutils literal notranslate"><span class="pre">bc_input</span></code>,
consistent keywords should be used to describe like data so this can be
associated and distinguished correctly. Combinations of these keywords with
the other identifiers (such as species and domain) should allow associated data
in a timeseries to be identified.</p>
<p>See the <span class="xref std std-ref">Modifying and deleting data</span> tutorial for how to update stored
metadata if needed.</p>
</section>
<section id="reviewing-what-is-in-the-object-store">
<h3>Reviewing what is in the object store<a class="headerlink" href="#reviewing-what-is-in-the-object-store" title="Link to this heading">#</a></h3>
<p>To check the data and metadata already stored within an object store,
use the <code class="docutils literal notranslate"><span class="pre">search</span></code> function from within the <code class="docutils literal notranslate"><span class="pre">openghg.retrieve</span></code> sub-module:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.retrieve</span> <span class="kn">import</span> <span class="n">search</span>

<span class="n">search_results</span> <span class="o">=</span> <span class="n">search</span><span class="p">()</span>
<span class="n">search_results</span><span class="o">.</span><span class="n">results</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_type</th>
      <th>processed by</th>
      <th>processed on</th>
      <th>raw file used</th>
      <th>species</th>
      <th>domain</th>
      <th>source</th>
      <th>author</th>
      <th>processed</th>
      <th>source_format</th>
      <th>...</th>
      <th>height</th>
      <th>high_spatial_resolution</th>
      <th>heights</th>
      <th>variables</th>
      <th>title</th>
      <th>date_created</th>
      <th>bc_input</th>
      <th>min_height</th>
      <th>max_height</th>
      <th>input_filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>flux</td>
      <td>cv18710@bristol.ac.uk</td>
      <td>2021-01-08 12:18:49.803837+00:00</td>
      <td>/home/cv18710/work_shared/gridded_fluxes/ch4/u...</td>
      <td>ch4</td>
      <td>europe</td>
      <td>anthro</td>
      <td>openghg cloud</td>
      <td>2023-01-27 09:52:03.717769+00:00</td>
      <td>openghg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>footprints</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>europe</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>100m</td>
      <td>False</td>
      <td>[500.0, 1500.0, 2500.0, 3500.0, 4500.0, 5500.0...</td>
      <td>[fp, temperature, pressure, wind_speed, wind_d...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>boundary_conditions</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ch4</td>
      <td>europe</td>
      <td>NaN</td>
      <td>openghg cloud</td>
      <td>2023-01-27 11:45:22.736279+00:00</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ecmwf cams ch4 volume mixing ratios at domain ...</td>
      <td>2018-11-13 09:25:29.112138</td>
      <td>cams</td>
      <td>500.0</td>
      <td>19500.0</td>
      <td>ch4_europe_201607.nc</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 32 columns</p>
</div><p>Here we see the data types we’ve added, along with the keywords used when
standarising the data.</p>
<p>To search for just one data type a specific <code class="docutils literal notranslate"><span class="pre">search_*</span></code> function can be
used (or the <code class="docutils literal notranslate"><span class="pre">data_type</span></code> input of <code class="docutils literal notranslate"><span class="pre">&quot;flux&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&quot;boundary_conditions&quot;</span></code> can be passed to the <code class="docutils literal notranslate"><span class="pre">search</span></code> function). For
example, for flux data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.retrieve</span> <span class="kn">import</span> <span class="n">search_flux</span>

<span class="n">search_results_flux</span> <span class="o">=</span> <span class="n">search_flux</span><span class="p">()</span>
<span class="n">search_results_flux</span><span class="o">.</span><span class="n">results</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_type</th>
      <th>processed by</th>
      <th>processed on</th>
      <th>raw file used</th>
      <th>species</th>
      <th>domain</th>
      <th>source</th>
      <th>author</th>
      <th>processed</th>
      <th>source_format</th>
      <th>start_date</th>
      <th>end_date</th>
      <th>max_longitude</th>
      <th>min_longitude</th>
      <th>max_latitude</th>
      <th>min_latitude</th>
      <th>high_time_resolution</th>
      <th>time_period</th>
      <th>uuid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>flux</td>
      <td>cv18710@bristol.ac.uk</td>
      <td>2021-01-08 12:18:49.803837+00:00</td>
      <td>/home/cv18710/work_shared/gridded_fluxes/ch4/u...</td>
      <td>ch4</td>
      <td>europe</td>
      <td>anthro</td>
      <td>openghg cloud</td>
      <td>2023-01-27 09:52:03.717769+00:00</td>
      <td>openghg</td>
      <td>2016-01-01 00:00:00+00:00</td>
      <td>2016-12-31 23:59:59+00:00</td>
      <td>39.38</td>
      <td>-97.9</td>
      <td>79.057</td>
      <td>10.729</td>
      <td>standard</td>
      <td>1 year</td>
      <td>b16fefdf-c92d-4cc9-8aac-367bcb6b82fe</td>
    </tr>
  </tbody>
</table>
</div><p>In this case the <code class="docutils literal notranslate"><span class="pre">source</span></code> value has been set to <code class="docutils literal notranslate"><span class="pre">&quot;anthro&quot;</span></code>.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">bc_input</span></code> keywords can also include “-”
to logically separate the descriptor e.g. “anthro-waste” but should not
include other separators.</p>
</section>
</section>
<section id="input-format">
<h2>2. Input format<a class="headerlink" href="#input-format" title="Link to this heading">#</a></h2>
<p>For each of the data types seen above, there is an associated object from the
<code class="docutils literal notranslate"><span class="pre">openghg.store</span></code> sub-module:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Footprints</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Flux</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BoundaryConditions</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EulerianModel</span></code> <a class="footnote-reference brackets" href="#f1" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p></li>
</ul>
<p>To get information about the expected format <a class="footnote-reference brackets" href="#f6" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a> for a data type,
use the <code class="docutils literal notranslate"><span class="pre">.schema()</span></code> method for the associated object.</p>
<section id="input-format-for-flux-data">
<h3>Input format for flux data<a class="headerlink" href="#input-format-for-flux-data" title="Link to this heading">#</a></h3>
<p>For instance, to see the schema for flux data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.store</span> <span class="kn">import</span> <span class="n">Flux</span>

<span class="n">Flux</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DataSchema(data_vars={&#39;flux&#39;: (&#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;)}, dtypes={&#39;lat&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;lon&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;time&#39;: &lt;class &#39;numpy.datetime64&#39;&gt;, &#39;flux&#39;: &lt;class &#39;numpy.floating&#39;&gt;}, dims=None)
</pre></div>
</div>
<p>This tells us that the netCDF input for “flux” should contain:</p>
<ul class="simple">
<li><p>Data variables:</p>
<ul>
<li><p>“flux” data variable with dimensions of (“time”, “lat”, “lon”)</p></li>
</ul>
</li>
<li><p>Data types:</p>
<ul>
<li><p>“flux”, “lat”, “lon” variables/coordinates should be float type</p></li>
<li><p>“time” coordinate should be <code class="docutils literal notranslate"><span class="pre">datetime64</span></code></p></li>
</ul>
</li>
</ul>
</section>
<section id="input-format-for-footprints">
<h3>Input format for footprints<a class="headerlink" href="#input-format-for-footprints" title="Link to this heading">#</a></h3>
<p>Similarly for <code class="docutils literal notranslate"><span class="pre">Footprints</span></code>, as described in the standardisations
section, there are a few different input options available:</p>
<ul class="simple">
<li><p>inert species (default - integrated footprint)</p></li>
<li><p>high spatial resolution (<code class="docutils literal notranslate"><span class="pre">high_spatial_res</span></code> flag)</p></li>
<li><p>high time resolution (<code class="docutils literal notranslate"><span class="pre">high_time_res</span></code> flag) (e.g. for carbon dioxide)</p></li>
<li><p>short-lived species (<code class="docutils literal notranslate"><span class="pre">short_lifetime</span></code> flag)</p></li>
<li><p>particle locations (<code class="docutils literal notranslate"><span class="pre">particle_locations</span></code> - default is True, expect to be included)</p></li>
</ul>
<p>These can be shown by passing keywords to the <code class="docutils literal notranslate"><span class="pre">.schema()</span></code> method.</p>
<section id="default-inert-footprint-format">
<h4>Default (inert) footprint format<a class="headerlink" href="#default-inert-footprint-format" title="Link to this heading">#</a></h4>
<p>For example, if nothing is passed this returns the details for an integrated
footprint for an inert species:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.store</span> <span class="kn">import</span> <span class="n">Footprints</span>
<span class="n">Footprints</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DataSchema(data_vars={&#39;fp&#39;: (&#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;), &#39;particle_locations_n&#39;: (&#39;time&#39;, &#39;lon&#39;, &#39;height&#39;), &#39;particle_locations_e&#39;: (&#39;time&#39;, &#39;lat&#39;, &#39;height&#39;), &#39;particle_locations_s&#39;: (&#39;time&#39;, &#39;lon&#39;, &#39;height&#39;), &#39;particle_locations_w&#39;: (&#39;time&#39;, &#39;lat&#39;, &#39;height&#39;)}, dtypes={&#39;lat&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;lon&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;time&#39;: &lt;class &#39;numpy.datetime64&#39;&gt;, &#39;fp&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;height&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;particle_locations_n&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;particle_locations_e&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;particle_locations_s&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;particle_locations_w&#39;: &lt;class &#39;numpy.floating&#39;&gt;}, dims=None)
</pre></div>
</div>
<p>This tells us that the default netCDF input for “footprints” should
contain:</p>
<ul class="simple">
<li><p>Data variables:</p>
<ul>
<li><p>“fp” data variable with dimensions of (“time”, “lat”, “lon”)</p></li>
<li><p>“particle_locations_n”, “particle_locations_s” with dimensions of (“time”, “lon”, “height”)</p></li>
<li><p>“particle_locations_e”, “particle_locations_w” with dimensions of (“time”, “lat”, “height”)</p></li>
</ul>
</li>
<li><p>Data types:</p>
<ul>
<li><p>“fp”, “lat”, “lon”, “height” variables / coordinates should be float type</p></li>
<li><p>“particle_locations_n”, “particle_locations_e”, “particle_locations_s”, “particle_locations_w” variables should also be float type</p></li>
<li><p>“time” coordinate should be datetime64</p></li>
</ul>
</li>
</ul>
<p>The “fp” data variable describes the sensivity map within the regional
domain. The “particle_locations_*” variables describe the senitivity
map at each of the ordinal boundaries of the domain. Setting the
<code class="docutils literal notranslate"><span class="pre">particle_locations</span></code> flag as False (True by default) would remove the
requirement for these particle location boundary sensitivies to be
included.</p>
</section>
<section id="other-footprint-formats">
<h4>Other footprint formats<a class="headerlink" href="#other-footprint-formats" title="Link to this heading">#</a></h4>
<p>For species with a short lifetime the input footprints require
additional variables. This can be seen by passing the <code class="docutils literal notranslate"><span class="pre">short_lifetime</span></code>
flag:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Footprints</span><span class="o">.</span><span class="n">schema</span><span class="p">(</span><span class="n">short_lifetime</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DataSchema(data_vars={&#39;fp&#39;: (&#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;), &#39;particle_locations_n&#39;: (&#39;time&#39;, &#39;lon&#39;, &#39;height&#39;), &#39;particle_locations_e&#39;: (&#39;time&#39;, &#39;lat&#39;, &#39;height&#39;), &#39;particle_locations_s&#39;: (&#39;time&#39;, &#39;lon&#39;, &#39;height&#39;), &#39;particle_locations_w&#39;: (&#39;time&#39;, &#39;lat&#39;, &#39;height&#39;), &#39;mean_age_particles_n&#39;: (&#39;time&#39;, &#39;lon&#39;, &#39;height&#39;), &#39;mean_age_particles_e&#39;: (&#39;time&#39;, &#39;lat&#39;, &#39;height&#39;), &#39;mean_age_particles_s&#39;: (&#39;time&#39;, &#39;lon&#39;, &#39;height&#39;), &#39;mean_age_particles_w&#39;: (&#39;time&#39;, &#39;lat&#39;, &#39;height&#39;)}, dtypes={&#39;lat&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;lon&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;time&#39;: &lt;class &#39;numpy.datetime64&#39;&gt;, &#39;fp&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;height&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;particle_locations_n&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;particle_locations_e&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;particle_locations_s&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;particle_locations_w&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;mean_age_particles_n&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;mean_age_particles_e&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;mean_age_particles_s&#39;: &lt;class &#39;numpy.floating&#39;&gt;, &#39;mean_age_particles_w&#39;: &lt;class &#39;numpy.floating&#39;&gt;}, dims=None)
</pre></div>
</div>
<p>This tells us that, in addition to the “default” variables, for
short-lived species there also must be:</p>
<ul class="simple">
<li><p>Additional data variables:</p>
<ul>
<li><p>“mean_age_particles_n”, “mean_age_particles_s” with dimensions of (“time”, “lon”, “height”)</p></li>
<li><p>“mean_age_particles_e”, “mean_age_particles_w” with dimensions of (“time”, “lat”, “height”)</p></li>
</ul>
</li>
<li><p>Data types:</p>
<ul>
<li><p>all new variables should be float type</p></li>
</ul>
</li>
</ul>
<p>Similiarly for the <code class="docutils literal notranslate"><span class="pre">high_time_res</span></code> and <code class="docutils literal notranslate"><span class="pre">high_spatial_res</span></code> flags to
the <code class="docutils literal notranslate"><span class="pre">Footprints.schema()</span></code> method, these require additional variables
within the input footprint files.</p>
</section>
</section>
</section>
<section id="cleanup">
<h2>3. Cleanup<a class="headerlink" href="#cleanup" title="Link to this heading">#</a></h2>
<p>If you’re finished with the data in this tutorial you can clean up the
tutorial object store using the <code class="docutils literal notranslate"><span class="pre">clear_tutorial_store</span></code> function.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openghg.tutorial</span> <span class="kn">import</span> <span class="n">clear_tutorial_store</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clear_tutorial_store</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>LPDM means <em>Lagrangrian Particle Dispersion Model</em>.</p>
</aside>
<aside class="footnote brackets" id="f2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id6">2</a>)</span>
<p>“Flux” includes emissions (and depositions) of substances from (and to) a surface.
However, we use “flux” and “emissions” interchangeably.</p>
</aside>
<aside class="footnote brackets" id="f1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id3">1</a>,<a role="doc-backlink" href="#id4">2</a>,<a role="doc-backlink" href="#id8">3</a>)</span>
<p><code class="docutils literal notranslate"><span class="pre">eulerian_model</span></code> isn’t available yet.</p>
</aside>
<aside class="footnote brackets" id="f4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">4</a><span class="fn-bracket">]</span></span>
<p>Recall, <em>standardising</em> is the process that adds data and metadata from
raw data files to the object store.</p>
</aside>
<aside class="footnote brackets" id="f5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">5</a><span class="fn-bracket">]</span></span>
<p>CAMS means <em>Copernicus Atmosphere Monitoring Service</em></p>
</aside>
<aside class="footnote brackets" id="f6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">6</a><span class="fn-bracket">]</span></span>
<p>“Expected format” and “OpenGHG format” are both used in the docs.</p>
</aside>
</aside>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Adding_observation_data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Adding observation data</p>
      </div>
    </a>
    <a class="right-next"
       href="Creating_data_from_databases.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Using databases to add data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-tutorial-object-store">Using the tutorial object store</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-and-standardising-data">1. Adding and standardising data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-domains">Data domains</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#footprints">Footprints</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chunking">Chunking</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#default-chunking">Default chunking</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#manual-chunking">Manual chunking</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#flux-emissions">Flux / Emissions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary conditions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-defined-keywords-source-and-bc-input">User defined keywords: <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">bc_input</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reviewing-what-is-in-the-object-store">Reviewing what is in the object store</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input-format">2. Input format</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-format-for-flux-data">Input format for flux data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-format-for-footprints">Input format for footprints</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#default-inert-footprint-format">Default (inert) footprint format</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#other-footprint-formats">Other footprint formats</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleanup">3. Cleanup</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023 OpenGHG development team.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>