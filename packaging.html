
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Packaging releases &#8212; OpenGHG 0+untagged.1.g65e8b34.dirty documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/custom.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="index.html">
<p class="title">OpenGHG</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="features.html">
  Features
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="install.html">
  Installation instructions
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="development/index_devel.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api/index.html">
  User API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api/index_devapi.html">
  Developer API
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-a-release">
   Defining a release
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-release">
   Creating a release
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing-the-packages">
   Testing the packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tagging-a-new-release">
   Tagging a new release
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uploading-packages-to-pypi">
   Uploading packages to pypi
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing-the-final-release">
   Testing the final release
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="packaging-releases">
<h1>Packaging releases<a class="headerlink" href="#packaging-releases" title="Permalink to this headline">#</a></h1>
<p>Pack and Doc is now fully tested and deployed using GitHub actions.
The development process should be;</p>
<ul class="simple">
<li><p>New features are developed on feature branches, called <code class="docutils literal notranslate"><span class="pre">feature-{feature}</span></code>,
either in the <a class="reference external" href="https://github.com/openghg/openghg">main Pack and Doc repository</a>
for authorised developers, or in personal forks for
new developers.</p></li>
<li><p>Bug fixes or issue fixes are developed on fix branches, called
<code class="docutils literal notranslate"><span class="pre">fix-issue-{number}</span></code> (again in either the main repository or forks).</p></li>
<li><p>Pull requests are issued from these branches to <code class="docutils literal notranslate"><span class="pre">devel</span></code>. All merge conflicts
must be fixed in the branch and all tests must pass before the pull
request can be merged into <code class="docutils literal notranslate"><span class="pre">devel</span></code>.</p></li>
</ul>
<p>The result of this is that “devel” should contain the fully-working and
tested, and most up-to-date version of <code class="docutils literal notranslate"><span class="pre">pack</span> <span class="pre">and</span> <span class="pre">doc</span></code>. However, this
version should not be used for production runs.</p>
<section id="defining-a-release">
<h2>Defining a release<a class="headerlink" href="#defining-a-release" title="Permalink to this headline">#</a></h2>
<p>We will release <code class="docutils literal notranslate"><span class="pre">pack</span> <span class="pre">and</span> <span class="pre">doc</span></code> regularly. Releases aim to be backwards
compatible and capable of being used for production runs, at least for
the functionality that is fully described in the tutorial.</p>
<p>We use <a class="reference external" href="https://semver.org">semantic versioning</a> and take care
not to cause breaking changes in the public API.</p>
</section>
<section id="creating-a-release">
<h2>Creating a release<a class="headerlink" href="#creating-a-release" title="Permalink to this headline">#</a></h2>
<p>To create a release first checkout the “main” branch.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout main
git pull
</pre></div>
</div>
<p>Next, merge in all changes from the “devel” branch.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git pull origin devel
</pre></div>
</div>
<p>Next, update the <a class="reference internal" href="changelog.html"><span class="doc">Changelog</span></a> with details about this release. This
should include the link at the top of the release that shows the commit
differences between versions. This can be easily copied from a previous
release and updated, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`0.11.2 &lt;https://github.com/metawards/MetaWards/compare/0.11.1...0.11.2&gt;`__ - May 11th 2020
</pre></div>
</div>
<p>could be changed to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`0.12.0 &lt;https://github.com/metawards/MetaWards/compare/0.11.2...0.12.0&gt;`__ - May 18th 2020
</pre></div>
</div>
<p>when moving from the 0.11.2 to 0.12.0 release.</p>
<p>Now push this change back to GitHub, using;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git push
</pre></div>
</div>
<p>This will trigger a CI/CD run which will build and test everything on
Windows, Mac and Linux for Python 3.7 and 3.8. Everything should work,
as “devel” should have been in a release-ready state.</p>
</section>
<section id="testing-the-packages">
<h2>Testing the packages<a class="headerlink" href="#testing-the-packages" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://github.com/metawards/MetaWards/actions">GitHub actions</a> will
produce the source and binary wheels for <code class="docutils literal notranslate"><span class="pre">metawards</span></code> on all supported
platforms. This will be in an artifact called <code class="docutils literal notranslate"><span class="pre">dist</span></code> which you should
download and unpack.</p>
<img alt="Image of the GitHub Actions interface showing the dist artifact" src="images/github_artifacts.jpg" />
<p>You should unpack these into the <code class="docutils literal notranslate"><span class="pre">dist</span></code> directory, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> dist
unzip ~/Downloads/dist.zip
</pre></div>
</div>
<p>This should result in six binary wheels and once source package, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metawards</span><span class="o">-</span><span class="mf">0.11.1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp37</span><span class="o">-</span><span class="n">cp37m</span><span class="o">-</span><span class="n">macosx_10_14_x86_64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11.1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp37</span><span class="o">-</span><span class="n">cp37m</span><span class="o">-</span><span class="n">manylinux1_x86_64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11.1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp37</span><span class="o">-</span><span class="n">cp37m</span><span class="o">-</span><span class="n">win_amd64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11.1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">macosx_10_14_x86_64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11.1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">manylinux1_x86_64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11.1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">win_amd64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11.1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p>Try to install the package related to you machine, just to double-check
that it is working, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install ./metawards-0.11.1+7.g52b3671-cp37-cp37m-macosx_10_14_x86_64.whl
<span class="nb">cd</span> ..
pytest tests
</pre></div>
</div>
<p>Once it is working, remove these temporary packages from your <code class="docutils literal notranslate"><span class="pre">dist</span></code> folder,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm dist/*
</pre></div>
</div>
</section>
<section id="tagging-a-new-release">
<h2>Tagging a new release<a class="headerlink" href="#tagging-a-new-release" title="Permalink to this headline">#</a></h2>
<p>Now that you are happy that the release is ready, you can tag the new
version. Do this using the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">tag</span></code> command, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git tag -a <span class="o">{</span>VERSION<span class="o">}</span> -m <span class="s2">&quot;{VERSION} release&quot;</span>
</pre></div>
</div>
<p>replacing <code class="docutils literal notranslate"><span class="pre">{VERSION}</span></code> with the version number. For this 0.12.0 release
the command would be;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git tag -a <span class="m">0</span>.12.0 -m <span class="s2">&quot;0.12.0 release&quot;</span>
</pre></div>
</div>
<p>Next, push your tag to GitHub;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git push --tags
</pre></div>
</div>
<p>The tag will be used by automatic versioning script to generate
the version numbers of the code. Building the package
(as happens below) will automatically update the _version.py
that is included in the package to tag versions.</p>
<p>This will also trigger a full CI/CD to test and build the new version.
Again, it should work as this tag was taken from your fully-tested
“main” branch.</p>
</section>
<section id="uploading-packages-to-pypi">
<h2>Uploading packages to pypi<a class="headerlink" href="#uploading-packages-to-pypi" title="Permalink to this headline">#</a></h2>
<p>While you are waiting for the CI/CD GitHub Actions to complete, make sure
that your version of twine is fully up to date;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install --upgrade twine
</pre></div>
</div>
<p>Once GitHub actions is complete, you will see that another build artifact
is ready for download. Download this and unpack it into your <code class="docutils literal notranslate"><span class="pre">dist</span></code>
directory as before. You should now have a <code class="docutils literal notranslate"><span class="pre">dist</span></code> directory that
contains six binary wheels and one source package, named according to
the release version. For example, for the 0.11.2 release we had;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ls dist
 metawards-0.11.2-cp37-cp37m-macosx_10_14_x86_64.whl
 metawards-0.11.2-cp37-cp37m-manylinux1_x86_64.whl
 metawards-0.11.2-cp37-cp37m-win_amd64.whl
 metawards-0.11.2-cp38-cp38-macosx_10_14_x86_64.whl
 metawards-0.11.2-cp38-cp38-manylinux1_x86_64.whl
 metawards-0.11.2-cp38-cp38-win_amd64.whl
 metawards-0.11.2.tar.gz
</pre></div>
</div>
<p>Now you can upload to pypi using the command;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 -m twine upload dist/*
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will need a username and password for pypi and to have
permission to upload code to this project. Currently only
the release manager has permission. If you would like
join the release management team then please get in touch.</p>
</div>
</section>
<section id="testing-the-final-release">
<h2>Testing the final release<a class="headerlink" href="#testing-the-final-release" title="Permalink to this headline">#</a></h2>
<p>Finally(!) test the release on a range of different machines by logging
in and typing;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install <span class="nv">metawards</span><span class="o">=={</span>VERSION<span class="o">}</span>
</pre></div>
</div>
<p>replacing <code class="docutils literal notranslate"><span class="pre">{VERSION}</span></code> with the version number, e.g. for 0.11.2</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install <span class="nv">metawards</span><span class="o">==</span><span class="m">0</span>.11.2
</pre></div>
</div>
<p>Play with the code, run the tests and run some examples. Everything should
work as you have performed lots of prior testing to get to this stage.</p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022 OpenGHG development team.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>