

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>localclient API Detail &mdash; OpenGHG 0+untagged.1.g31d3af9 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/custom.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/openghg_logo_v1.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation instructions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Developer’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index_devapi.html">Developer API documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenGHG</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>localclient API Detail</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="localclient-api-detail">
<h1>localclient API Detail<a class="headerlink" href="#localclient-api-detail" title="Permalink to this headline">¶</a></h1>
<div class="section" id="get-single-site">
<h2>get_single_site<a class="headerlink" href="#get-single-site" title="Permalink to this headline">¶</a></h2>
<p>Used to search the object store using a site name, species and daterange and returns the data found.</p>
<dl class="py function">
<dt id="openghg.localclient.get_single_site">
<code class="sig-prename descclassname">openghg.localclient.</code><code class="sig-name descname">get_single_site</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">site</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">species</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">network</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_date</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>str<span class="p">, </span>pandas._libs.tslibs.timestamps.Timestamp<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">end_date</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>str<span class="p">, </span>pandas._libs.tslibs.timestamps.Timestamp<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inlet</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">average</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">instrument</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">keep_missing</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>bool<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">calibration_scale</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="../_modules/openghg/localclient/_get_observations.html#get_single_site"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.get_single_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Get measurements from one site as a list of xarray datasets.
If there are multiple instruments and inlets at a particular site,
note that the acrg_obs_defaults.csv file may be referenced to determine which instrument and inlet to use for each time period.
If an inlet or instrument changes at some point during time period, multiple datasets will be returned,
one for each inlet/instrument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site</strong> – Site of interest e.g. MHD for the Mace Head site.</p></li>
<li><p><strong>species_in</strong> (<em>str</em>) – Species identifier e.g. ch4 for methane.</p></li>
<li><p><strong>start_date</strong> – Output start date in a format that Pandas can interpret</p></li>
<li><p><strong>end_date</strong> – Output end date in a format that Pandas can interpret</p></li>
<li><p><strong>inlet</strong> – Inlet label. If you want to merge all inlets, use “all”</p></li>
<li><p><strong>average</strong> – Averaging period for each dataset.
Each value should be a string of the form e.g. “2H”, “30min” (should match pandas offset aliases format).</p></li>
<li><p><strong>keep_missing</strong> – Whether to keep missing data points or drop them.</p></li>
<li><p><strong>network</strong> – Network for the site/instrument (must match number of sites).</p></li>
<li><p><strong>instrument</strong> – Specific instrument for the site (must match number of sites).</p></li>
<li><p><strong>calibration_scale</strong> – Convert to this calibration scale (original scale and new scale must both be in acrg_obs_scale_convert.csv)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of xarray.Datasets</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="process-files">
<h2>process_files<a class="headerlink" href="#process-files" title="Permalink to this headline">¶</a></h2>
<p>Used to process files for storage in the local object store.</p>
<dl class="py function">
<dt id="openghg.localclient.process_files">
<code class="sig-prename descclassname">openghg.localclient.</code><code class="sig-name descname">process_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">files</span></em>, <em class="sig-param"><span class="n">data_type</span></em>, <em class="sig-param"><span class="n">site</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">network</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">instrument</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openghg/localclient/_process.html#process_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.process_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Process the passed file(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files</strong> (<em>str</em><em>, </em><em>list</em>) – Path of files to be processed</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) – Type of data to be processed (CRDS, GC etc)</p></li>
<li><p><strong>site</strong> (<em>str</em><em>, </em><em>default=None</em>) – Site code or name</p></li>
<li><p><strong>network</strong> (<em>str</em><em>, </em><em>default=None</em>) – Network name</p></li>
<li><p><strong>instrument</strong> (<em>str</em><em>, </em><em>default=None</em>) – Instrument name</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Should this data overwrite data</p></li>
<li><p><strong>for these datasources for existing dateranges</strong> (<em>stored</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>UUIDs of Datasources storing data of processed files keyed by filename</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="ranksources">
<h2>RankSources<a class="headerlink" href="#ranksources" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">RankSources</span></code> class is used to rank sources of data. Setting a high rank for a Datasource across a specific daterange means
that data from that Datasource will be preferred when a user searches for data.</p>
<dl class="py class">
<dt id="openghg.localclient.RankSources">
<em class="property">class </em><code class="sig-prename descclassname">openghg.localclient.</code><code class="sig-name descname">RankSources</code><a class="reference internal" href="../_modules/openghg/localclient/_rank_sources.html#RankSources"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.RankSources" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="openghg.localclient.RankSources.create_daterange">
<code class="sig-name descname">create_daterange</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start</span></em>, <em class="sig-param"><span class="n">end</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openghg/localclient/_rank_sources.html#RankSources.create_daterange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.RankSources.create_daterange" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a JSON serialisable daterange string for use in ranking dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>datetime</em>) – Start of daterange</p></li>
<li><p><strong>end</strong> (<em>datetime</em>) – End of daterange</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Serialisable daterange string</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="openghg.localclient.RankSources.get_sources">
<code class="sig-name descname">get_sources</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">site</span></em>, <em class="sig-param"><span class="n">species</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openghg/localclient/_rank_sources.html#RankSources.get_sources"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.RankSources.get_sources" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the datasources for this site and species to allow a ranking to be set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site</strong> (<em>str</em>) – Three letter site code</p></li>
<li><p><strong>species</strong> (<em>str</em>) – Species name</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary of datasource metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="openghg.localclient.RankSources.rank_sources">
<code class="sig-name descname">rank_sources</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">updated_rankings</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openghg/localclient/_rank_sources.html#RankSources.rank_sources"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.RankSources.rank_sources" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign the precendence of sources for each.
This function expects a dictionary of the form</p>
<p>{‘site_string’: {‘rank’: [daterange_str, …], ‘daterange’: ‘start_end’, ‘uuid’: uuid},</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>updated_ranking</strong> (<em>dict</em>) – Dictionary of ranking</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="openghg.localclient.RankSources.set_rank">
<code class="sig-name descname">set_rank</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rank_key</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">rank_data</span><span class="p">:</span> <span class="n">dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openghg/localclient/_rank_sources.html#RankSources.set_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.RankSources.set_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the rank data for the</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rank_key</strong> – Key of ranking data from the original dict</p></li>
<li><p><strong>by get_sources.</strong> (<em>return</em>) – </p></li>
<li><p><strong>rank_data</strong> – Dictionary of ranking data for example</p></li>
<li><p><strong>co2_hfd_50m_picarro</strong> – {1: [daterange_1], 2: [daterange_2]}</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="openghg.localclient.RankSources.visualise_rankings">
<code class="sig-name descname">visualise_rankings</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; pyvis.network.Network<a class="reference internal" href="../_modules/openghg/localclient/_rank_sources.html#RankSources.visualise_rankings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.RankSources.visualise_rankings" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a small network graph of ranked data with each rank given a colour</p>
<p>Note that this function should only be run from a Jupyter Notebook</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rank_data</strong> (<em>dict</em>) – Dictionary of the form given by RankSources.get_sources()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Network graph</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyvis.network.Network</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="search">
<h2>Search<a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h2>
<p>Search the local object store for data. This will be removed as it has been replaced with the <code class="docutils literal notranslate"><span class="pre">get_obs</span></code> function above.</p>
<dl class="py class">
<dt id="openghg.localclient.Search">
<em class="property">class </em><code class="sig-prename descclassname">openghg.localclient.</code><code class="sig-name descname">Search</code><a class="reference internal" href="../_modules/openghg/localclient/_search.html#Search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.Search" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to search and download data from the object store</p>
<dl class="py method">
<dt id="openghg.localclient.Search.retrieve">
<code class="sig-name descname">retrieve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">selected_keys</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openghg/localclient/_search.html#Search.retrieve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.Search.retrieve" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads the selected keys and returns a dictionary of
xarray Datasets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>str</em><em>, </em><em>list</em>) – Key(s) from search results to download</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary of Datasets</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>defaultdict(dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="openghg.localclient.Search.search">
<code class="sig-name descname">search</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">species</span></em>, <em class="sig-param"><span class="n">locations</span></em>, <em class="sig-param"><span class="n">inlet</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">instrument</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_datetime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">end_datetime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openghg/localclient/_search.html#Search.search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#openghg.localclient.Search.search" title="Permalink to this definition">¶</a></dt>
<dd><p>This is just a wrapper for the search function that allows easy access through LocalClient</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<em>str</em><em> or </em><em>list</em>) – Terms to search for in Datasources</p></li>
<li><p><strong>locations</strong> (<em>str</em><em> or </em><em>list</em>) – Where to search for the terms in species</p></li>
<li><p><strong>inlet</strong> (<em>str</em><em>, </em><em>default=None</em>) – Inlet height such as 100m</p></li>
<li><p><strong>instrument</strong> (<em>str</em><em>, </em><em>default=None</em>) – Instrument name such as picarro</p></li>
<li><p><strong>find_all</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Require all search terms to be satisfied</p></li>
<li><p><strong>start_datetime</strong> (<em>datetime</em><em>, </em><em>default=None</em>) – Start datetime for search</p></li>
<li><p><strong>None a start datetime of UNIX epoch</strong> (<em>If</em>) – </p></li>
<li><p><strong>end_datetime</strong> (<em>datetime</em><em>, </em><em>default=None</em>) – End datetime for search</p></li>
<li><p><strong>None an end datetime of the current datetime is set</strong> (<em>If</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of keys of Datasources matching the search parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020 OpenGHG development team
      <span class="lastupdated">
        Last updated on Nov 10, 2020.
      </span>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>