

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Development &mdash; OpenGHG 0+untagged.3.ge78c844 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../_static/custom.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fn Development" href="fn_devel.html" />
    <link rel="prev" title="Development" href="index_devel.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/images/openghg_logo_v1.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation instructions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index_devel.html">Development</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index_devel.html#python-development">Python development</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Development</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-your-computer">Setting up your computer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#coding-style">Coding Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workflow">Workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="#testing">Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#documentation">Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#committing">Committing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index_devel.html#fn-functions">Fn functions</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index_devapi.html">Developer API documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenGHG</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index_devel.html">Development</a> &raquo;</li>
        
      <li>Development</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="fn_devel.html" class="btn btn-neutral float-right" title="Fn Development" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="index_devel.html" class="btn btn-neutral float-left" title="Development" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="development">
<h1>Development<a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h1>
<p>The source code for OpenGHG is available on <a class="reference external" href="https://github.com/openghg/openghg">GitHub</a>.</p>
<section id="setting-up-your-computer">
<h2>Setting up your computer<a class="headerlink" href="#setting-up-your-computer" title="Permalink to this headline">¶</a></h2>
<p>OpenGHG requires Python &gt;= 3.7, so please install this before continuing
further.</p>
<section id="virtual-environment">
<h3>Virtual environment<a class="headerlink" href="#virtual-environment" title="Permalink to this headline">¶</a></h3>
<p>It is recommended that you develop OpenGHG in a Python
<a class="reference external" href="https://docs.python.org/3/tutorial/venv.html">virtual environment</a>.
Here we’ll create a new folder called <code class="docutils literal notranslate"><span class="pre">envs</span></code> in our home directory and create
a new <code class="docutils literal notranslate"><span class="pre">openghg_devel</span></code> environment in it.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir -p ~/envs/openghg_devel
python -m venv ~/envs/openghg_devel
</pre></div>
</div>
<p>Virtual environments provide sandboxes which make it easier to develop
and test code. They also allow you to install Python modules without
interfering with other Python installations.</p>
<p>We activate our new environment using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> ~/envs/openghg_devel/bin/activate
</pre></div>
</div>
<p>This will update your shell so that all python commands (such as
<code class="docutils literal notranslate"><span class="pre">python</span></code>, <code class="docutils literal notranslate"><span class="pre">pip</span></code> etc.) will use the virtual environment. You can
deactivate the environment and return to your system Python using;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>deactivate
</pre></div>
</div>
</section>
<section id="clone-openghg">
<h3>Clone OpenGHG<a class="headerlink" href="#clone-openghg" title="Permalink to this headline">¶</a></h3>
<p>As OpenGHG is currently in its very early stages and is not yet available on <code class="docutils literal notranslate"><span class="pre">pip</span></code> we need
clone the OpenGHG repository and then move into it and install the required dependencies.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/openghg/openghg.git
<span class="nb">cd</span> openghg
pip install -r requirements.txt
pip install -r requirements-dev.txt
</pre></div>
</div>
<p>OpenGHG should now be installed within your virtual environment.</p>
</section>
<section id="run-tests">
<h3>Run tests<a class="headerlink" href="#run-tests" title="Permalink to this headline">¶</a></h3>
<p>To ensure everything is working on your system running the tests is a good idea. To do this run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest -v tests
</pre></div>
</div>
</section>
</section>
<section id="coding-style">
<h2>Coding Style<a class="headerlink" href="#coding-style" title="Permalink to this headline">¶</a></h2>
<p>OpenGHG is written in Python 3 (&gt;= 3.7). We aim as much as possible to follow a
<a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a> python coding style and
recommend that use a linter such as <a class="reference external" href="https://flake8.pycqa.org/en/latest/">flake8</a>.</p>
<p>This code has to run on a wide variety of architectures, operating
systems and machines - some of which don’t have any graphic libraries,
so please be careful when adding a dependency.</p>
<p>With this in mind, we use the following coding conventions:</p>
<section id="naming">
<h3>Naming<a class="headerlink" href="#naming" title="Permalink to this headline">¶</a></h3>
<p>We follow a Python style naming convention.</p>
<ul class="simple">
<li><p>Packages: lowercase, singleword</p></li>
<li><p>Classes: CamelCase</p></li>
<li><p>Methods: snake_case</p></li>
<li><p>Functions: snake_case</p></li>
<li><p>Variables: snake_case</p></li>
<li><p>Source Files: snake_case with a leading underscore</p></li>
</ul>
<p>Functions or variables that are private should be named with a leading
underscore. This prevents them from being prominantly visible in Python’s
help and tab completion.</p>
</section>
<section id="modules">
<h3>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h3>
<p>OpenGHG consists of the main module, e.g. <code class="docutils literal notranslate"><span class="pre">openghg</span></code>, plus
a <code class="docutils literal notranslate"><span class="pre">openghg.submodule</span></code> module.</p>
<p>In addition, there is a <code class="docutils literal notranslate"><span class="pre">openghg.scripts</span></code> module which contains the
code for the various command-line applications.</p>
<p>To make OpenGHG easy for new developers
to understand, we have a set of rules that will ensure that only
necessary public functions, classes and implementation details are
exposed to the Python help system.</p>
<ul class="simple">
<li><p>Module files containing implementation details are prefixed with
an underscore, i.e. <code class="docutils literal notranslate"><span class="pre">_parameters.py</span></code></p></li>
<li><p>Each module file contains an <code class="docutils literal notranslate"><span class="pre">__all__</span></code> variable that lists the
specific items that should be imported.</p></li>
<li><p>The package <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> can be used to safely expose the required
functionality to the user with:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>This results in a clean API and documentation, with all extraneous information,
e.g. external modules, hidden from the user. This is important when working
interactively, since <a class="reference external" href="https://ipython.org">IPython</a>
and <a class="reference external" href="https://jupyter.org">Jupyter</a>
do not respect the <code class="docutils literal notranslate"><span class="pre">__all__</span></code> variable when auto-completing, meaning that the
user will see a full list of the available names when hitting tab. When
following the conventions above, the user will only be able to access the
exposed names. This greatly improves the clarity of the package, allowing
a new user to quickly determine the available functionality. Any user wishing
expose further implementation detail can, of course, type an underscore to
show the hidden names when searching.</p>
</section>
<section id="type-hinting">
<h3>Type hinting<a class="headerlink" href="#type-hinting" title="Permalink to this headline">¶</a></h3>
<p>Throughout the OpenGHG project we use type hinting which allows us to declare the type of the objects
that are going to be passed to and returned from functions. This helps improve user understanding of the code
and when used in conjunction with tools like <a class="reference external" href="https://mypy.readthedocs.io/en/stable/">mypy</a> can help
catch bugs.</p>
<p>If we are writing a function that accepts takes a string and returns a string we can add the types like so</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">greeter</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Greets the user</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of user</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: Greeting string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;Hello &#39;</span> <span class="o">+</span> <span class="n">name</span>
</pre></div>
</div>
<p>For a function that takes either a string or a list as its argument and returns a list we can write it as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="n">search_terms</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; A function that searches</span>

<span class="sd">        Args:</span>
<span class="sd">            search_terms: Search terms</span>
<span class="sd">        Returns:</span>
<span class="sd">            list: List of data found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># some excellent code</span>
</pre></div>
</div>
</section>
</section>
<section id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<section id="feature-branches">
<h3>Feature branches<a class="headerlink" href="#feature-branches" title="Permalink to this headline">¶</a></h3>
<p>First make sure that you are on the development branch of OpenGHG:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout devel
</pre></div>
</div>
<p>Now create and switch to a feature branch. This should be prefixed with
<em>feature</em>, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout -b feature-process
</pre></div>
</div>
</section>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>When working on your feature it is important to write tests to ensure that it
does what is expected and doesn’t break any existing functionality. All code added to the
project must be covered by tests and tests should be placed inside the <code class="docutils literal notranslate"><span class="pre">tests</span></code> directory, creating an appropriately
named sub-directory for any new submodules.</p>
<p>The test suite is intended to be run using
<a class="reference external" href="https://docs.pytest.org/en/latest/contents.html">pytest</a>.
When run, <code class="docutils literal notranslate"><span class="pre">pytest</span></code> searches for tests in all directories and files
below the current directory, collects the tests together, then runs
them. Pytest uses name matching to locate the tests. Valid names start
or end with <em>test</em>, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Files:</span>
<span class="n">test_file</span><span class="o">.</span><span class="n">py</span>       <span class="n">file_test</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Functions:</span>
<span class="k">def</span> <span class="nf">test_func</span><span class="p">():</span>
   <span class="c1"># code to perform tests...</span>

<span class="k">def</span> <span class="nf">func_test</span><span class="p">():</span>
   <span class="c1"># code to perform tests...</span>
</pre></div>
</div>
<p>We use the convention of <code class="docutils literal notranslate"><span class="pre">test_*</span></code> when naming files and functions.</p>
<section id="running-tests">
<h3>Running tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h3>
<p>To run the full test suite, simply type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest tests
</pre></div>
</div>
<p>To get more detailed information about each test, run pytests using the
<em>verbose</em> flag, e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest -v
</pre></div>
</div>
<p>For more information on the capabilties of <code class="docutils literal notranslate"><span class="pre">pytest</span></code> please see the
<a class="reference external" href="https://docs.pytest.org/en/stable/contents.html">pytest documentation</a>.</p>
</section>
<section id="continuous-integration-and-delivery">
<h3>Continuous integration and delivery<a class="headerlink" href="#continuous-integration-and-delivery" title="Permalink to this headline">¶</a></h3>
<p>We use GitHub Actions to run a full continuous integration (CI)
on all pull requests to devel and
master, and all pushes to devel and master. We will not merge a pull
request until all tests pass. We only accept pull requests to devel.
We only allow pull requests from devel to master. In addition to CI,</p>
</section>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>OpenGHG is fully documented using a combination of hand-written files
(in the <code class="docutils literal notranslate"><span class="pre">doc</span></code> folder) and auto-generated api documentation created from
Google <a class="reference external" href="https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_google.html">style docstrings</a>.
for details. The documentation is automatically built using <a class="reference external" href="http://sphinx-doc.org">Sphinx</a>. Whenever a commit is pushed to devel the
documentation is automatically rebuilt and updated.</p>
<p>To build the documentation locally you will first need to install some
additional packages. If you haven’t yet installed the developer requirements please do so by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -r requirements-dev.txt
</pre></div>
</div>
<p>Next ensure you have <a class="reference external" href="https://pandoc.org/">pandoc</a> installed. Installation instructions
can be <a class="reference external" href="https://pandoc.org/installing.html">found here</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you haven’t installed <code class="docutils literal notranslate"><span class="pre">openghg</span></code> to your virtual environment you can add the folder path to your PYTHONPATH.
This allows the library to be used easily without the need for reinstallation after changes.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PYTHONPATH</span><span class="si">}</span><span class="s2">:/path/to/cloned/repo&quot;</span>
</pre></div>
</div>
</div>
<p>Then move to the <code class="docutils literal notranslate"><span class="pre">doc</span></code> directory and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make
</pre></div>
</div>
<p>When finished, point your browser to <code class="docutils literal notranslate"><span class="pre">build/html/index.html</span></code>.</p>
</section>
<section id="committing">
<h2>Committing<a class="headerlink" href="#committing" title="Permalink to this headline">¶</a></h2>
<p>If you create new tests, please make sure that they pass locally before
commiting. When happy, commit your changes, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git commit openghg/_new_feature.py tests/test_feature <span class="se">\</span>
    -m <span class="s2">&quot;Implementation and test for new feature.&quot;</span>
</pre></div>
</div>
<p>If your edits don’t change the OpenGHG source code e.g. fixing typos in the documentation,
then please add <code class="docutils literal notranslate"><span class="pre">[skip</span> <span class="pre">ci]</span></code> to your commit message.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git commit -a -m <span class="s2">&quot;Updating docs [ci skip]&quot;</span>
</pre></div>
</div>
<p>This will avoid unnecessarily running the
<a class="reference external" href="https://github.com/openghg/openghg/actions">GitHub Actions</a>, e.g. running all the tests
and rebuilding the documentation of the OpenGHG package etc. GitHub actions are configured in the file
<code class="docutils literal notranslate"><span class="pre">.github/workflows/main.yaml</span></code>).</p>
<p>Next, push your changes to the remote server:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Push to the feature branch on the main OpenGHG repo, if you have access.</span>
git push origin feature

<span class="c1"># Push to the feature branch your own fork.</span>
git push fork feature
</pre></div>
</div>
<p>When the feature is complete, create a <em>pull request</em> on GitHub so that the
changes can be merged back into the development branch.
For information, see the documentation
<a class="reference external" href="https://help.github.com/articles/about-pull-requests">here</a>.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="fn_devel.html" class="btn btn-neutral float-right" title="Fn Development" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index_devel.html" class="btn btn-neutral float-left" title="Development" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020 OpenGHG development team.
      <span class="lastupdated">
        Last updated on Jul 13, 2021.
      </span>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>